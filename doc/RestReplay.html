<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html; charset=us-ascii" http-equiv="content-type">
  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.12), see www.w3.org">
  

  <title>RestReplay</title>
  <style type="text/css">
  h1, h2, h3, h4, h5 {
    font-family: Helvetica, 'San Serif';
  }
  td a {
    font-weight: bold;
  }

  .element-hdr, .pathrow {
    font-size: 100%; line-height: 13pt; color: rgb(51, 51, 51); font-weight: bold; background-image: none; background-color: rgb(173, 216, 230);
  }
  .code {
      font-size: 90%;
    white-space: pre;
    font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
    border: 1px dashed rgb(187, 187, 187); margin: 0px 0px 10px; 
    padding: 0px; 
    overflow: auto; color: black; 
    hidebackground-color: rgb(220, 240, 220);
    background-color: rgb(240, 250, 240);
  }
  .panel {
    border: 1px dashed rgb(187, 187, 187); margin: 0px 0px 10px; padding: 0px; overflow: auto; color: black; 
    background-color: rgb(240, 240, 240);   
  }
  .comments {
      font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
      font-weight: normal;
      font-style: normal;
      font-size: 110%;
      color: rgb(0, 130, 0);
  }
    
  .public {
      color: blue;
  }
  .note1 {
      color: brown;
      font-weight: bold;
  }

  .matrix {
      border: 0px solid gray;
      border-spacing: 3px;
  }
  .matrix th {
      padding: 5px;
      font-family: Helvetica, 'Sans Serif';
      font-size: 80%;
      border: 0px solid gray;
      background-color: #b0c8c0;
  }
  .matrix td {
      font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
      margin: 5px;
      padding: 4px;
      border: 1px solid gray;
      background-color: #eee;
  }
  #content {
      margin: 20px;
      border: 0px solid green;
  }
  .cheatsheet-body {
      border: 1px solid green;
      background-color: rgb(220, 240, 220);
  }
  #TOCDEST1 {
      width: 48%;
      font-size: 90%;
      float: left;
      margin-right; 0px;
  }
  #TOCDEST2 {
      font-size: 90%;
      width: 48%;
      float: right;
      margin-left: 0;
      }
  div.container {
      padding: 10px;
      border: 1px solid #000000;
      overflow: auto;
      width: 100%;
      background-color: #b0c8c0;
  }
  .cheatsheet-header {
      background-color: #b0cfc0;
      border-bottom: 1px solid green;
      padding: 6px;
      font-weight: bold;
      font-size: 90%;
      font-family: Helvetica, 'San Serif';
      text-align: center;
  }
  .main-toc {
      margin-top: 20px;
      font-size: 70%;
      padding: 20px;
      border: 1px solid black;
      background-color: lightblue;
      display: inline-block;
  }

  </style>
</head>

<body>
  <div id="content" class="page view">
    <div class="wiki-content">
    <h1><a name="RestReplay-RestReplayDocumentation" id="RestReplay-RestReplayDocumentation"></a>RestReplay Documentation</h1>
    <div class="container">
        <center>
<h2>RestReplay Quick Reference</h2></center>
        <div id="TOCDEST1" class="cheatsheet-body"></div>
        <div id="TOCDEST2" class="cheatsheet-body"></div>
    </div>

    <span class="main-toc">
    <h2><a href="#RestReplay-1.Introduction">1. Introduction</a></h2>
    <h3><a href="#RestReplay-1.a.Features">1.a. Features</a></h3>
    <h3><a href="#RestReplay-1.bOverview">1.b Overview</a></h3>
    <h4><a href="#RestReplay-1.b.1Runtime">1.b.1 Runtime</a></h4>

    <h2><a href="#RestReplay-2.ReferenceDocumentation">2. Reference Documentation</a></h2>
    <h3><a href="#RestReplay-2.a.Installation">2.a. Installation</a></h3>
    <h3><a href="#RestReplay-2.b.Configuration">2.b. Configuration</a></h3>
    <h4><a href="#RestReplay-2.b.1GeneralRules">2.b.1 General Rules</a></h4>
    <h3><a href="#RestReplay-2.cRunning">2.c Running</a></h3>
    <h4><a href="#RestReplay-2.c.1Commandlineparameters">2.c.1 Command-line parameters</a></h4>
    <h4><a href="#RestReplay-2.c.2XMLconfigurationparametersinmasterfile">2.c.2 XML configuration parameters in <b>master</b> file</a></h4>
    <h4><a href="#RestReplay-2.c.3XMLconfigurationparametersincontrolfile">2.c.3 XML configuration parameters in <b>control</b> file</a></h4>
    <h4><a href="#RestReplay-2.c.4Cleanup">2.c.4 Cleanup</a></h4>

    </span>
    

    <h2><a name="RestReplay-1.Introduction" id="RestReplay-1.Introduction"></a>1. RestReplay Introduction</h2>

      <p><span class="Apple-style-span">RestReplay is a utility to send REST requests to the services layer (including JSON, XML, and multipart XML requests), read responses, and compare<br>
      the resulting payloads with templates.</span></p>

      <h3><a name="RestReplay-1.a.Features" id="RestReplay-1.a.Features"></a>1.a. Features</h3>

      <ul>
        <li>Completely configurable via XML.</li>

        <li>Abstracts each transaction with server as a "test".</li>

        <li>Multiple tests can be grouped in a testGroup element, and each test may refer to previous tests within testGroup.</li>

        <li>Automatic cleanup of resources allocated within a testGroup.</li>

        <li>Send and receive JSON and XML payloads or MIME-multipart payloads.</li>

        <li>File-based request and response payloads.</li>

        <li>Variable expansion in: URLs, headers, request payloads, and response payloads.</li>

        <li>Simple reporting of results on console and in surefire reports.</li>

        <li>Programmatic interface for driving the tests and testGroups, and for finer control of reporting and cleanup.</li>
      </ul>

      <h3><a name="RestReplay-1.bOverview" id="RestReplay-1.bOverview"></a>1.b Overview</h3>

      <h4><a name="RestReplay-1.b.1Runtime" id="RestReplay-1.b.1Runtime"></a>1.b.1 Runtime</h4>

      <p>At runtime, RestReplay consults parameters passed in on the command line, or from maven surefire.</p>

      <p>RestReplay then determines which <b>master</b> file to use. This file points to <b>control</b> files that contain tests.</p>

      <p>The default behavior of RestReplay is to look for a directory, called the RestReplay directory.<br>
      When running inside maven surefire, this is pre-defined to be a resource directory in the source code module,</p>

      <p>Maven defines a variable called basedir, which points at the project directory for the current pom.xml.<br>
      If we build services in /src/trunk/services, then basedir=/src/trunk/services/IntegrationTests/</p>

      <div class="code panel">
      RestReplayBasedir=${basedir}/src/test/resources/test-data/restreplay
        or:
      /src/trunk/services/IntegrationTests/src/test/resources/test-data/restreplay
      </div>

      <p>Within the RestReplay directory, there are various <b>master</b> files, some control files, and directories for each service.<br>
      Most services should define their <b>control</b> file within their directory, e.g.</p>

      <div class="code panel">
      restreplay/xml-replay-master.xml         <span class="comments">//the <b>master</b> file used by the nightly build.</span>
      restreplay/dev-master.xml                <span class="comments">//the <b>master</b> file for local development.</span>
      restreplay/objectexit/                   <span class="comments">//the directory for all objectexit <b>control</b> files, and request/response templates.</span>
      restreplay/objectexit/object-exit.xml    <span class="comments">//the <b>control</b> file for objectexit.</span>
      restreplay/objectexit/res/               <span class="comments">//a sub-directory to contain response templates.</span>
      </div>

      <p>For development, you may use a predefined <b>master</b> file, called dev-master.xml, or you may define your own. See "2.c. Running"<br>
      For integration testing, use the predefined <b>master</b> file called xml-replay-master.xml.</p>

      <p>Within a <b>control</b> file, RestReplay finds testGroup elements as specified on the command line or in the <b>master</b> file, <br>
      and then runs these testGroup elements.</p>

      <p>For each testGroup, a namespace is set up that will contain the results of all tests run in that testGroup, and any variables<br>
      defined as the test runs. This namespace contains variables that dereference to java objects, so Strings, Date objects, etc.<br>
      may be put into the namespace. For every test, RestReplay creates a named object of type<br>
      org.dynamide.restreplay.ServiceResult, so that after that test has run, you<br>
      may pull fields out of the ServiceResult object, such as responseCode, fullURL, location, and CSID as calculated from the <b>Location:</b> header.</p>

      <p>You may also use methods on the ServiceResult object that give you XPath access to any field in any part either sent<br>
      or recieved from the server in that test.</p>

      <p>ServiceResult methods and fields:</p>

      <div class="code">
      public class ServiceResult ::

          <span class="comments">//dig into the schema part from the expanded request, identified by partName,</span>
          <span class="comments">//  and get the text value of node identified by xpath</span>
          public String sent(String partName, String xpath);

          <span class="comments">//dig into the schema part returned by the server, identified by partName,</span>
          <span class="comments">// and get the text value of node identified by xpath </span>
          public String got(String partName, String xpath);

          public String CSID <span class="comments">//just the CSID of the resource created or modified.</span>

          public String location <span class="comments">//the Location: header value of the resource, which is a full URL.</span>
      </div>
      <p>For each "test" node in a testGroup, RestReplay sets up a request, using the URI (which may contain expressions), the http method, and<br>
      any parts specified for a POST or a PUT. The parts are read from text files in a directory relative to the RestReplay base directory,<br>
      and may contain/define variables which get passed in. The value of these variables is evaluated in the <b>control</b> file just prior to<br>
      the test node being run. So previous tests may be referenced. The parts are expanded for any expressions, and then put together<br>
      in the appropriate http sequence and submitted to the server. The response from the server is then made available to the test to<br>
      check using the "response" node. The "response" node allows you to specify a template file to compare, and any variables declared<br>
      will be evaluated just prior to comparing the response from the server to the response template file.</p>

      <p>After the testGroup has run, RestReplay will perform cleanup. You may control cleanup via the "autoDeletePOSTS" attribute of "testGroup".<br>
      If true, then RestReplay does a DELETE on each resource allocated.<br>
      If false, RestReplay does no automatic DELETEs.<br>
      You may also programmatically call RestReplay, in which case you can programmatically control cleanup of individual tests.<br>
      See "2.c.4 Cleanup"</p>

      <p>Finally, results are aggregated and spit out to the command line console, and/or to maven surefire reports. You can customize<br>
      how verbose these results are using the "dump" node in the <b>master</b> file.</p>

      <p>If all testGroups and all tests succeed, then RestReplay tells maven surefire that the suite succeeded. Otherwise, maven surefire is told<br>
      that the suite failed. In this case, you may examine the console, or look at the maven surefire report, which will contain a tabular summary<br>
      of all testGroups and tests. You may have to click "show all results" in the maven surefire report.</p>

      <p>RestReplay also creates a stand-alone report. Look at the command line output where RestReplay will report the location of this HTML report, e.g. something of this form:</p>
      <pre>RestReplay summary report: .../test/resources/test-data/restreplay/rest-replay-reports/...
</pre>This reports directory starts with an index file named after any <b>master</b> file you have run, which links to individual <b>control</b> file results.

      
<h2><a name="RestReplay-2.ReferenceDocumentation" id="RestReplay-2.ReferenceDocumentation"></a>2. Reference Documentation</h2>

      <h3><a name="RestReplay-2.a.Installation" id="RestReplay-2.a.Installation"></a>2.a. Installation</h3>

      <h3><a name="RestReplay-2.b.Configuration" id="RestReplay-2.b.Configuration"></a>2.b. Configuration</h3>

      <h4><a name="RestReplay-2.b.1GeneralRules" id="RestReplay-2.b.1GeneralRules"></a>2.b.1 General Rules</h4>

      <p>General Variable Syntax: starts with letter or underscore (_), contains letters, numbers, underscore. No<br>
      other special characters, especially not the dollar-sign ($).</p>

      <p>For an ID attribute to be valid, please use General Variable Syntax.</p>

      <p>Element names should also follow the General Variable Syntax.</p>

      <p>General Filename syntax: please stick to General Variable Syntax plus hyphen (-) and period (.).<br>
      Filenames may contain the delimiter / to denote directories. These will be transformed into platform-specific directory separators.</p>

      <h3><a name="RestReplay-2.cRunning" id="RestReplay-2.cRunning"></a>2.c Running</h3>

      <p>You can run RestReplay on the command-line, or from the command-line of maven surefire.</p>

      <p>To run using the maven surefire test, simply:</p>

      <div class="code">
    mvn -o install test \<br>        -D-restReplayBaseDir=./src/test/resources/test-data/restreplay \<br>        -D-restReplayMaster=rest-replay-master.xml
      </div>

      <p>or</p>

      <div class="code">
    mvn test -Dtest=RestReplayMasterTest
      </div>

      <p>To run using just one test, testGroup, or <b>control</b> file, use RestReplayDevTest, and then modify dev-master.xml, which already exists.</p>

      <div class="code">
    cd /src/trunk/services/IntegrationTests
    vi ./src/test/resources/test-data/restreplay/dev-master.xml
    mvn test -Dtest=RestReplayDevTest
      </div>

      <p>or define your own <b>master</b> file, which you create:</p>

      <div class="code">
    cd /src/trunk/services/IntegrationTests
    vi ./src/test/resources/test-data/restreplay/my-master-file.xml
    mvn test -DrestReplayMaster=my-master-file.xml \<br>             -DforkMode=never \<br>             -Dtest=RestReplayDevTest
      </div>

      <h4><a name="RestReplay-2.c.1Commandlineparameters" id="RestReplay-2.c.1Commandlineparameters"></a>2.c.1 Command-line parameters</h4>

        <p>If you are using a jar distribution, then this example would run the environment <b>local</b> using the directory <b>/.tests</b>
            for control files and will put reports in <b>/.tests/rest-replay-reports</b>.  From that directory, it will find the master
            control file, <b>rest-replay-master.xml</b> .</p>

        <div class="code">
       java -jar lib/RestReplay-1.0.3-standalone.jar \
            -restReplayBaseDir <b>./tests</b> \
            -restReplayMaster <b>master.xml</b> \
            -envID <b>local</b>
        </div>

      <h4><a name="RestReplay-2.c.2XMLconfigurationparametersinmasterfile" id="RestReplay-2.c.2XMLconfigurationparametersinmasterfile"></a>2.c.2 XML configuration parameters in <b>master</b> file</h4>

      <p>Click on an element to jump to documentation for that element and its attributes.</p>



      <div id="TOCMASTER" class="cheatsheet-body">
      <div class="cheatsheet-header">Master control file</div>
      <pre>  &lt;<a href="#RestReplay-restReplayMaster">restReplayMaster</a>&gt;
      &lt;<a href="#RestReplay-restReplayMaster.dump">dump</a>/&gt;
      &lt;<a href="#RestReplay-restReplayMaster.auths">auths</a>&gt;
          &lt;<a href="#RestReplay-restReplayMaster.auths.auth">auth</a>&gt;
      &lt;/auths&gt;
      &lt;<a href="#RestReplay-restReplayMaster.runOptions">runOptions</a>&gt;
        &lt;connectionTimeout /&gt;
        &lt;socketTimeout /&gt;
        &lt;errorsBecomeEmptyStrings /&gt;
      &lt;/runOptions&gt;
      &lt;vars&gt;
        &lt;<a href="#RestReplay-restReplayMaster.vars.var">var</a> /&gt;
      &lt;/vars&gt;
      &lt;<a href="#RestReplay-restReplayMaster.envs">envs</a>&gt;
          &lt;<a href="#RestReplay-restReplayMaster.envs.vars">vars</a>&gt;
            &lt;<a href="#RestReplay-restReplayMaster.envs.vars.var">var</a> /&gt;
          &lt;/vars&gt;
      &lt;/envs&gt;
      &lt;<a href="#RestReplay-restReplayMaster.run">run</a>&gt;&lt;/run&gt;
  &lt;/restReplayMaster&gt;</pre>
      </div>
      <table border="1" cellpadding="3" cellspacing="0">
        <tbody>
          <tr>
            <td colspan="3" class="pathrow element-hdr"><a name="RestReplay-restReplayMaster" id="RestReplay-restReplayMaster"></a>/restReplayMaster</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>
                dump<br>
                auths<br>
                runOptions<br>
                vars<br>
                envs<br>
                run<br>
            </td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.dump" id="RestReplay-restReplayMaster.dump"></a>/restReplayMaster/dump</td>
          </tr>

          <tr>
              <td>@dumpServiceResult</td>

              <td>minimal - a one-line display<br>
                  detailed - enough information to debug<br>
                  full - more verbose, includes payloads</td>
          </tr>

          <tr>
              <td>@payloads</td>

              <td>dumps payloads after summary result.</td>
          </tr>
          <tr>
              <td>Matrix:</td>

              <td>
                  <table class="matrix">
                      <tbody>
<tr>
                          <td><br></td><th>payloads true</th><th>payloads false</th>
                      </tr>
                      <tr>
                          <th>auto</th><td>detail + payloads</td>
<td>detail <b style="color:orange;">+payloads if error</b></td>
                      </tr>
                      <tr>
                          <th>full</th><td>detail + payloads</td>
<td>detail</td>
                      </tr>
                      <tr>
                          <th>detailed</th><td>detail</td>
<td>detail</td>
                      </tr>
                      <tr>
                          <th>minimal</th><td>minimal</td>
<td>minimal</td>
                      </tr>
                  </tbody></table>
              </td>
          </tr>


          <tr>
              <td>Example:</td>

              <td>
                  <br>
                  <div class="code">&lt;dump dumpServiceResult="detailed" payloads="false" /&gt;</div>
              </td>
          </tr>




          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.auths" id="RestReplay-restReplayMaster.auths"></a>/restReplayMaster/auths</td>
          </tr>

          <tr>
              <td><br></td>

              <td>A list of users and their related Base-64 encrypted<tt>username:password</tt>strings. You can generate these strings in number of
                  ways, among them by using the online utility at<a href="http://www.motobit.com/util/base64-decoder-encoder.asp" class="external-link" rel="nofollow">http://www.motobit.com/util/base64-decoder-encoder.asp</a>.</td>
          </tr>

          <tr>
              <td>@default</td>

              <td>the user ID to use if none is specified in the test</td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.auths.auth" id="RestReplay-restReplayMaster.auths.auth"></a>/restReplayMaster/auths/auth</td>
          </tr>

          <tr>
              <td>@ID</td>

              <td>a cspace user ID</td>
          </tr>

          <tr>
              <td>element text</td>

              <td>Base-64 encrypted username:password</td>
          </tr>

          <tr>
              <td>Example:</td>

              <td>
                  <p>Example:</p>

                  <div class="code">&lt;auths default="admin@example.org"&gt;
    &lt;auth ID="user1@museum1"&gt;dXNlcjFAbXVzZXVtMS5vcmc6dXNlcjFAbXVzZXVtMS5vcmc=&lt;/auth&gt;
    &lt;auth ID="bigbird2010"&gt;YmlnYmlyZDIwMTA6YmlnYmlyZDIwMTA=&lt;/auth&gt;
    &lt;auth ID="elmo2010"&gt;ZWxtbzIwMTA6ZWxtbzIwMTA=&lt;/auth&gt;
&lt;/auths&gt;                  </div>
              </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.run" id="RestReplay-restReplayMaster.runOptions"></a>/restReplayMaster/runOptions</td>
          </tr>

          <tr>
            <td>connectionTimeout</td>

            <td>Timeout for connecting to remote servers</td>
          </tr>
          <tr>
            <td>socketTimeout</td>

            <td>Timeout for data transfer</td>
          </tr>

          <tr>
            <td>errorsBecomeEmptyStrings</td>

            <td>boolean: true|false.  Set to true if you want undefined vars and errors in var syntax to become empty strings, otherwise they are left intact in the template.</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
<div class="code">    &lt;runOptions&gt;
        &lt;connectionTimeout&gt;3000&lt;/connectionTimeout&gt;
        &lt;socketTimeout&gt;3000&lt;/socketTimeout&gt;
        &lt;errorsBecomeEmptyStrings&gt;true&lt;/errorsBecomeEmptyStrings&gt;
    &lt;/runOptions&gt;           </div></td>
          </tr>


          <tr>
<td>Discussion:</td>
<td>This file is the best place to do site-wide settings for RestReplay<br><br>&nbsp;&nbsp;&nbsp; All of these options can be controlled in a master file, too,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; but you should do that only in two cases:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1) you are developing locally, and are setting per-test cases while you run tests,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and you may or may not check in your changes.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In this case, change any settings you like as close to the testCase as you can in the chain:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; runOptions/master/testGroup/testCase<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Review any changes to your xml config and control files you commit,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and check strategy as outlined in case (2).<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2) you are committing this master to source control, so that it gets picked up by automated builds.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In this case, you should have a coordinated reason for overriding this default file (runOptions.xml).<br><br>&nbsp;&nbsp;&nbsp; Options:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "connectionTimeout"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "socketTimeout"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The most reasonable override in a master file's RunOptions is the timeouts:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; these may vary by service, or host<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; so one clean organization of test would be by services<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or known clusters of hosts with particular timeouts.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; You could have one control file, say, "master-edge-services.xml",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with one testGroup, "timeCriticalServices", and in that testGroup put all the services from,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say, a time-critical cluster.&nbsp; In that control file,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set the RunOption timeouts to be low.&nbsp; In the Master, set the timeouts to be more "normal".<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All the other tests will run with "normal", and tests in master-edge-services.xml<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in testGroup "timeCriticalServices" will run with low timeouts.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "errorsBecomeEmptyStrings" would be set locally if you were debugging.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "dumpResourceManagerSummary" should probably be best left<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to the central location in this file (runOptions.xml)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; since it controls output to the console.<br><br>&nbsp;&nbsp;&nbsp; The heirarchy is:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RunOptions : class defaults<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; runOptions.xml : default for all tests<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my-master.xml :&nbsp; overrides properties for this master.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; You can have many masters and run them all from the command line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or test suite by using the startup command-line parameter:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -restReplayMaster relative-path-to-master-file<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or for maven, surefire, etc:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DrestReplayMaster=relative-path-to-master-file<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (see docs/RestReplay.html for examples).<br>&nbsp;&nbsp;&nbsp; </td>
<td><br></td></tr>
<tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.run" id="RestReplay-restReplayMaster.vars.var"></a>/restReplayMaster/vars/var</td>
          </tr>
          <tr>
            <td>@id</td>

            <td>The name of the variable.  var elements declared here are available to all tests.  These are useful for
            defining host endpoints, or other values that will apply across all tests under a master.</td>
          </tr>
          <tr>
            <td>Example:</td>

            <td>
<div class="code">    &lt;restReplayMaster&gt;
        &lt;protoHostPort&gt;<b>${SNOOPSERVER}</b>&lt;/protoHostPort&gt;
        &lt;vars&gt;
            &lt;var ID="<b>PISERVER</b>"&gt;http://piserver.example.com&lt;/var&gt;
            &lt;var ID="<b>LASSERVER</b>"&gt;http://localhost:8080&lt;/var&gt;
            &lt;var ID="<b>SNOOPSERVER</b>"&gt;http://localhost:28082&lt;/var&gt;
        &lt;/vars&gt;
        ...
    &lt;/restReplayMaster&gt;

    <b>Then, in a test file, you can use full URLs which reference these servers
    defined in the master control file:</b>

    &lt;restReplay&gt;
        &lt;protoHostPort&gt;<b>${LASSERVER}</b>&lt;/protoHostPort&gt;

        &lt;testGroup ID="mainTestGroup" autoDeletePOSTS="false"&gt;

            &lt;test ID="pitoken"&gt;
                &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
                &lt;method&gt;POST&lt;/method&gt;
                &lt;uri&gt;<b>${PISERVER}</b>/v1/piapi-int/tokens&lt;/uri&gt;
                &lt;filename&gt;pitoken.json&lt;/filename&gt;
            &lt;/test&gt;

            &lt;test ID="createAssignment"&gt;
                &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
                &lt;method&gt;POST&lt;/method&gt;
                &lt;uri&gt;<b>${SNOOPSERVER}</b>/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;

            &lt;test ID="getAssignments"&gt;
                &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
                &lt;method&gt;GET&lt;/method&gt;
                &lt;uri&gt;/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;
        &lt;/testGroup&gt;
    &lt;/restReplay&gt;

      <b>"uri" values that have a full url will go to that host. If they don't have http://host:port,
        then they will use "protoHostPort" element from the test file, then the
        master file.
        In this case:</b>
          createAssignment will go against SNOOPSERVER:  http://localhost:28082
          getAssignments will go against LASSERVER:      http://localhost:8080
          pitoken will go against PISERVER               http://piserver.example.com
   
<hr>    <b>But if protoHostPort were not defined in this test file, then the
    protoHostPort will be pulled in from the master file.</b>


        &lt;restReplayMaster&gt;
            &lt;protoHostPort&gt;<b>${SNOOPSERVER}</b>&lt;/protoHostPort&gt;
            &lt;vars&gt;
                &lt;var ID="<b>PISERVER</b>"&gt;http://piserver.example.com&lt;/var&gt;
                &lt;var ID="<b>LASSERVER</b>"&gt;http://localhost:8080&lt;/var&gt;
                &lt;var ID="<b>SNOOPSERVER</b>"&gt;http://localhost:28082&lt;/var&gt;
            &lt;/vars&gt;
            ...
            <run controlfile="_self_test/dynamide.xml" testgroup="secondTestGroup">
        &lt;/restReplayMaster&gt;

        &lt;restReplay&gt;
          &lt;testGroup ID="secondTestGroup" autoDeletePOSTS="false"&gt;
            &lt;test ID="getAssignments"&gt;
                &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
                &lt;method&gt;GET&lt;/method&gt;
                &lt;uri&gt;/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;
          &lt;/testGroup&gt;
       &lt;/restReplay&gt;

      <b>In this case, getAssignments will use the default from protoHostPort in
      the master file:</b>
      secondTestGroup.getAssignments will go against SNOOPSERVER               http://localhost:28082
<br><br></run></div></td>
          </tr>






          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.envs" id="RestReplay-restReplayMaster.envs"></a>/restReplayMaster/envs</td>
          </tr>

          <tr>
              <td>&nbsp;</td>

              <td>Contains blocks of vars/var elements which define variables available to all tests run by this master.
                  <br>The calling program can supply the environment ID in the command-line parameter <b>-envID</b>.
              <br>
              <br>
                  If calling restReplayInstance.readOptionsFromMasterConfigFile() programmatically, call restReplayInstance.setEnvID() first.
              </td>
          </tr>

          <tr>
              <td>child elements</td>

              <td><a href="#RestReplay-restReplayMaster.envs.vars">vars</a>
                  <br><a href="#RestReplay-restReplayMaster.envs.vars.var">vars/var</a></td>
          </tr>

          <tr>
              <td>@ID</td>

              <td>The environment ID, which is available for selection from the command line parameter -envID, or the call RestReplay.setEnvID()</td>
          </tr>

          <tr>
              <td>default</td>

              <td>If true, this is the env which will be used if the user supplies none on the command line or programmatically.</td>
          </tr>


          <tr>
              <td>Example:</td>

              <td>
                  <div class="code">&lt;restReplayMaster&gt;
    &lt;protoHostPort&gt;${BESERVER}&lt;/protoHostPort&gt;
    &lt;envs&gt;
        &lt;env ID="local" default="true"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://localhost:8080&lt;/var&gt;
                &lt;var ID="DMSERVER"&gt;http://localhost:18080&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
        &lt;env ID="dev"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://be.example.com&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
        &lt;env ID="qa"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://be.example.com&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
    &lt;/envs&gt;
    ...
    </div>

          </td></tr><tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.envs.vars" id="RestReplay-restReplayMaster.envs.vars"></a>/restReplayMaster/envs/vars</td>
          </tr>

          <tr>
              <td>child elements</td>

              <td>var</td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.envs.vars.var" id="RestReplay-restReplayMaster.envs.vars.var"></a>/restReplayMaster/envs/vars/var</td>
          </tr>

          <tr>
              <td><br></td>

              <td>A single variable, which will be available to all tests called by this master.
                  Behaves exactly like <a href="#RestReplay-restReplayMaster.vars.var">/restReplayMaster/vars/var</a></td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplayMaster.run" id="RestReplay-restReplayMaster.run"></a>/restReplayMaster/run</td>
          </tr>

          <tr>
              <td>@controlFile</td>

              <td>name of <b>control</b> file, relative to RestReplay directory</td>
          </tr>

          <tr>
              <td>@testGroup</td>

              <td>ID of single testGroup within <b>control</b> file to run. To run multiple tests, use multiple /restReplayMaster/run elements.</td>
          </tr>

          <tr>
              <td>Example:</td>

              <td>
                  <span class="code">&lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;</span>
              </td>
          </tr>
          <tr>
              <td>Example:</td>

              <td>
                  <div class="code">&lt;restReplayMaster&gt;
    ....
    &lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;
    &lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;
                  </div>
              </td>
          </tr>

        </tbody>
      </table>












      <h4><a name="RestReplay-2.c.3XMLconfigurationparametersincontrolfile" id="RestReplay-2.c.3XMLconfigurationparametersincontrolfile"></a>2.c.3 XML configuration parameters in <b>control</b> file</h4>

      <p>Click on an element to jump to documentation for that element and its attributes.</p>
      <div id="TOCTEST" class="cheatsheet-body">
      <div class="cheatsheet-header">Test control file</div>
      <pre>  &lt;<a href="#RestReplay-restReplay">restReplay</a>&gt;
      &lt;<a href="#RestReplay-restReplay.auths">auths</a>&gt;
          &lt;<a href="#RestReplay-restReplay.auths.auth">auth</a>&gt;&lt;/auth&gt;
      &lt;/auths&gt;
      &lt;<a href="#RestReplay-restReplay.testGroup">testGroup</a>&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.protoHostPort">protoHostPort</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.vars.var">vars</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.headers.header">headers</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.test">test</a>&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.method">method</a>&gt;&lt;/method&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.uri">uri</a>&gt;&lt;/uri&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.var">vars</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.var">var /</a>&gt;
              &lt;/vars&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.parts">headers</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.part">header /</a>&gt;
              &lt;/headers&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.parts">parts</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.part">part</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.label">label /</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.filename">filename /</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.var">var /</a>&gt;
                  &lt;/part&gt;
              &lt;/parts&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.response">response</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.expected">expected</a>/&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts">parts</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part">part</a>&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.label">label</a>&gt;&lt;/label&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.f...">filename</a>&gt;&lt;/filename&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.var">var</a>&gt;&lt;/var&gt;
                      &lt;/part&gt;
                  &lt;/parts&gt;
              &lt;/response&gt;
          &lt;/test&gt;
      &lt;/testGroup&gt;
  &lt;/restReplay&gt;</pre>
     </div>
      <table border="1" cellpadding="3" cellspacing="0">
        <tbody>
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay" id="RestReplay-restReplay"></a>/restReplay</td>
          </tr>

          <tr>
            <td>restReplay</td>

            <td>Root element of an RestReplay <b>control</b> file.</td>
          </tr>

          <tr>
            <td>child nodes</td>

            <td>protoHostPort<br>
                          auths<br>
                          testGroup</td>
          </tr>







          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.vars.var" id="RestReplay-restReplay.testGroup.vars.var"></a>/restReplay/vars/var</td>
          </tr>
          <tr>
            <td>var</td>
            <td>A variable that will be expanded just before the test is run.  Available to use in uri element.</td>
          </tr>
          <tr>
            <td>Example:</td>
            <td>
              <div class="code">
    &lt;restReplay&gt;
      &lt;protoHostPort&gt;...&lt;/protoHostPort&gt;
      &lt;testGroup ID="mainTestGroup"&gt;
        &lt;vars&gt;
            &lt;var ID="<b>COURSE_ID</b>"&gt;540f4515e4b004e7d8f22fc8&lt;/var&gt;
            &lt;var ID="TEMPLATE_ID"&gt;87fff5f0-652d-11e4-8229-179090669834&lt;/var&gt;
        &lt;/vars&gt;
        ...
        &lt;test ID="getAssignments"&gt;
            &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
            &lt;method&gt;GET&lt;/method&gt;
            &lt;uri&gt;/las-api/api/grid-apex/courses/<b>${COURSE_ID}</b>/assignments&lt;/uri&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.headers.header" id="RestReplay-restReplay.testGroup.headers.header"></a>/restReplay/headers/header</td>
          </tr>
          <tr>
            <td>header</td>
            <td>A header that will be expanded just before the test is run.  If you need to force a particular test to skip including all the headers,
            set inheritHeaders="false" on that &lt;test&gt; node.</td>
          </tr>
          <tr>
            <td>Example:</td>
            <td>
              <div class="code">
    <restreplay>
      &lt;testGroup ID="mainTestGroup"&gt;
        &lt;headers&gt;
            &lt;header name="X-ApiKey"&gt;19d26d452432968c9b636c9daf0c6d9b&lt;/header&gt;
            &lt;header name="x-authorization"&gt;${pitoken.got("//data")}&lt;/header&gt;
        &lt;/headers&gt;
        &lt;vars&gt;
            &lt;var ID="COURSE_ID"&gt;540f4515e4b004e7d8f22fc8&lt;/var&gt;
            &lt;var ID="TEMPLATE_ID"&gt;87fff5f0-652d-11e4-8229-179090669834&lt;/var&gt;
        &lt;/vars&gt;

        &lt;test ID="pitoken" <span class="note1">inheritHeaders="false"</span>&gt;
            &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
            &lt;method&gt;POST&lt;/method&gt;
            &lt;uri&gt;${PISERVER}/v1/piapi-int/tokens&lt;/uri&gt;
            &lt;filename&gt;pitoken.json&lt;/filename&gt;
            <b>&lt;-- Will NOT inherit headers --&gt;</b>
        &lt;/test&gt;

        &lt;test ID="deleteTemplate"&gt;
            &lt;expectedCodes&gt;200&lt;/expectedCodes&gt;
            &lt;method&gt;DELETE&lt;/method&gt;
            &lt;uri&gt;/las-api/api/grid-apex/courses/${COURSE_ID}/templates/${TEMPLATE_ID}&lt;/uri&gt;
            <b>&lt;-- Will inherit headers: X-ApiKey and x-authorization --&gt;</b>
        &lt;/test&gt;
              </restreplay></div>
            </td>
          </tr>








          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.auths" id="RestReplay-restReplay.auths"></a>/restReplay/auths</td>
          </tr>

          <tr>
            <td>auths</td>

            <td>This element adds to any auths placed in the <b>master</b> file. Any ID defined in the <b>control</b> file<br>
            overrides an auth of the same ID defined in the <b>master</b> file.</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>auth</td>
          </tr>

          <tr>
            <td>@default</td>

            <td>the user ID to use if none is specified in the test</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.auths.auth" id="RestReplay-restReplay.auths.auth"></a>/restReplay/auths/auth</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>a cspace user ID</td>
          </tr>

          <tr>
            <td>element text</td>

            <td>Base-64 encrypted username:password</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>Example:</p>

              <div class="code">
&lt;auths default="admin@example.org"&gt;
&lt;auth ID="admin@example.org"&gt;YWRtaW5AY29sbGVjdGlvbnNwYWNlLm9yZzpBZG1pbmlzdHJhdG9y&lt;/auth&gt;
&lt;/auths&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup" id="RestReplay-restReplay.testGroup"></a>/restReplay/testGroup</td>
          </tr>

          <tr>
            <td>testGroup</td>
            <td>Runs a group of tests</td>
          </tr>

          <tr>
            <td>child elements</td>
            <td>headers<br>
                          vars<br>
                          test
          </td></tr>

          <tr>
            <td>@ID</td>

            <td>A unique, valid ID for this testGroup.<br>
            The <b>master</b> file uses this ID in its /restReplayMaster/run element to specify this testGroup to run.</td>
          </tr>

          <tr>
            <td>@autoDeletePOSTS</td>

            <td>"true" - resource will be autoDeleted.<br>
            "false" - resources will not be autoDeleted</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>Example:</p>

              <div class="code">
&lt;testGroup ID="CRUDL" autoDeletePOSTS="true"&gt;
  &lt;test ID="foo"&gt;....&lt;/test&gt;
&lt;/testGroup&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test" id="RestReplay-restReplay.testGroup.test"></a>/restReplay/testGroup/test</td>
          </tr>

          <tr>
            <td>test</td>

            <td>A test exists in a testGroup, and defines one request/response/validation set.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>This ID must be unique within this file. Will become a variable name in the expression context bound to the ServiceResult object for this request/response.</td>
          </tr>

          <tr>
            <td>@auth</td>

            <td>the ID of the /restReplay/auths/auth or /restReplayMaster/auths/auth element to use for this request.<br>
            IMPORTANT: These are sticky - they stick around until reset by the next @auth specified in a test, in exec order of the tests in this file.</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>method<br>
            uri<br>
            part<br>
            parts</td>
          </tr>

          <tr>
            <td>Example</td>

            <td>
              <div class="code panel">
&lt;test ID="oePersonauthority"&gt;
     &lt;method&gt;POST&lt;/method&gt;
     &lt;uri&gt;/cspace-services/personauthorities/&lt;/uri&gt;
     &lt;part&gt;
         &lt;label&gt;personauthorities_common&lt;/label&gt;
         &lt;filename&gt;objectexit/oePersonauthority.xml&lt;/filename&gt;
     &lt;/part&gt;
&lt;/test&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td>Example</td>

            <td>
              This example shows switching auths between tests, and how the auths are sticky.<br>
              "permBigbird" and "accountBigbird" tests are run as user admin@example.org<br>
              and "dimension1" and "dimension1" tests are run as user bigbird2010.

              
<div class="code">
&lt;!-- Set up permissions and account, and test bigbird2010 --&gt;
&lt;test ID="permBigbird" auth="admin@example.org"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/authorization/permissions&lt;/uri&gt;
    &lt;filename&gt;security/1-bigbird-permission.xml&lt;/filename&gt;
&lt;/test&gt;
&lt;test ID="accountBigbird"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/accounts&lt;/uri&gt;
    &lt;filename&gt;security/5-account-bigbird.xml&lt;/filename&gt;
&lt;/test&gt;
&lt;test ID="dimension1"  auth="bigbird2010"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/dimensions/&lt;/uri&gt;
    &lt;part&gt;
        &lt;label&gt;dimensions_common&lt;/label&gt;
        &lt;filename&gt;dimension/1.xml&lt;/filename&gt;
    &lt;/part&gt;
&lt;/test&gt;
&lt;test ID="dimension2"&gt;
    &lt;method&gt;PUT&lt;/method&gt;
    &lt;uri&gt;/cspace-services/dimensions/${dimension1.CSID}&lt;/uri&gt;
    &lt;part&gt;
        &lt;label&gt;dimensions_common&lt;/label&gt;
        &lt;filename&gt;dimension/2-put.xml&lt;/filename&gt;
    &lt;/part&gt;
&lt;/test&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.method" id="RestReplay-restReplay.testGroup.test.method"></a>/restReplay/testGroup/test/method</td>
          </tr>

          <tr>
            <td>method</td>

            <td>GET<br>
            POST<br>
            PUT<br>
            DELETE</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.uri" id="RestReplay-restReplay.testGroup.test.uri"></a>/restReplay/testGroup/test/uri</td>
          </tr>

          <tr>
            <td>uri</td>

            <td>The portion of the URL after protocol, host, and port.</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              Examples:<br>
              If URL is<a href="http://localhost:8180/cspace-services/personauthorities/" class="external-link" rel="nofollow">http://localhost:8180/cspace-services/personauthorities/</a><br>
              then uri is /cspace-services/personauthorities/<br>
              The uri contains any required queryString parameters:

              
<div class="code">
    &lt;uri&gt;/cspace-services/objectexit/?sortBy=&amp;pgNum=2&amp;pgSz=1&lt;/uri&gt;
                </div>
              

              <p>The uri element may contain expression variables:</p>

              <div class="code">
    &lt;uri&gt;/cspace-services/personauthorities/${oePersonauthority.CSID}&lt;/uri&gt;
              </div>

              <p>This example uses the CSID returned in the Location header the server sent back when executing &lt;test ID="oePersonauthority"&gt;</p>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts" id="RestReplay-restReplay.testGroup.test.parts"></a>/restReplay/testGroup/test/parts</td>
          </tr>

          <tr>
            <td>parts</td>

            <td>Optional container for "part" elements. Needed if there are more than one part element, otherwise not needed.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part" id="RestReplay-restReplay.testGroup.test.parts.part"></a><a name="RestReplay-restReplay.testGroup.test.part" id="RestReplay-restReplay.testGroup.test.part"></a>/restReplay/testGroup/test/part<br>
            /restReplay/testGroup/test/parts/part</td>
          </tr>

          <tr>
            <td>part</td>

            <td>If there is just one part, the parts container element may be omitted.<br>
            A schema part sent to server in request, identified by a schema name in the "label" child element.<br>
            Models a request schema part sent in either a multipart mime message,<br>
            or in a CSpace 1.4 style application/xml message delimited by xml elements describing the schema part.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.label" id="RestReplay-restReplay.testGroup.test.parts.part.label"></a>/restReplay/testGroup/test/parts/part/label</td>
          </tr>

          <tr>
            <td>label</td>

            <td>A schema name for this part, such as "objectexit_common", or "collectionspace_core".</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.filename" id="RestReplay-restReplay.testGroup.test.parts.part.filename"></a>/restReplay/testGroup/test/parts/part/filename</td>
          </tr>

          <tr>
            <td>filename</td>

            <td>The filename of the payload, relative to the RestReplay directory (not relative to the <b>control</b> file).</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>&amp;&lt;filename&gt;objectexit/object-exit.xml&lt;/filename&gt;</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.var" id="RestReplay-restReplay.testGroup.test.parts.part.var"></a>/restReplay/testGroup/test/parts/part/var</td>
          </tr>

          <tr>
            <td>var</td>

            <td>Declares a variable to be made available to the expansion of the part template.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>the name of the variable that can be dereferenced in an expression e.g. &lt;var ID="depositor"&gt;...&lt;/var&gt;</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              var may be dereferenced in an expression in the request payload.like this:

              
<div class="code">
    &lt;depositor&gt;${depositor}&lt;/depositor&gt;
              </div>

              <p>The var itself may include any expression syntax in its element text, so that vars can be set based on any previous tests or java objects in the expression namespace.<br>
              e.g.</p>

              <div class="code">
    &lt;var ID="depositor"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
              </div><br>
              In context, this looks like:

              
<div class="code">
    &lt;test ID="oeObject"&gt;
        &lt;method&gt;POST&lt;/method&gt;
        &lt;uri&gt;/cspace-services/objectexit/&lt;/uri&gt;
        &lt;part&gt;
            &lt;label&gt;objectexit_common&lt;/label&gt;
            &lt;filename&gt;objectexit/oeObject.xml&lt;/filename&gt;
            &lt;var ID="depositor"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
            &lt;var ID="currentOwner"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
            &lt;var ID="exitNumber"&gt;oeObject-exitnum-123&lt;/var&gt;
        &lt;/part&gt;
    &lt;/test&gt;
              </div>

              <p>In this example, the ServiceResult object from the previous test identified by &lt;test ID="oePersonGET"&gt; exposes a method called got(String partLabel, String elementXPath), which can extract the node text for an element in a schema
              part returned by a response.</p>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response" id="RestReplay-restReplay.testGroup.test.response"></a>/restReplay/testGroup/test/response</td>
          </tr>

          <tr>
            <td>response</td>

            <td>Container for evaluating the response from the server</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>expected<br>
            parts<br>
            part</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.expected" id="RestReplay-restReplay.testGroup.test.response.expected"></a>/restReplay/testGroup/test/response/expected</td>
          </tr>

          <tr>
            <td>@level</td>

            <td>
              Single element for evaluating the response from the server. Specify the type of comparisons for validation with<br>
              attribute level: can be "ZERO", "TEXT", "ADDOK", "TREE", "TREE_TEXT", and "STRICT".<br>
              (For all tests, whitespace allowed by XML is ignored, and also ignoring whitespace at either end of child node text.<br>
              i.e. a child's text node is trimmed prior to comparison.)

              
<ul>
                <li>ZERO: does no checking. If the server sends a valid reponse, the reponse succeeds.</li>

                <li>ADDOK: Checks for TEXT differences. Nodes added by server, are allowed. Nodes expected by test but ommitted by server are in error.</li>

                <li>TEXT: makes sure nodes from the server match nodes from the file named in "filename" child element of "response".<br>
                Allows the server to add nodes, e.g. CSID, inAuthority, and other calculated fields may be skipped.</li>

                <li>TREE: makes sure no nodes/children are added or removed.</li>

                <li>TREE_TEXT: makes sure nodes match, and that no nodes/children are added or removed.</li>

                <li>STRICT makes sure all nodes match exactly. This is the strictest level of match.</li>
              </ul>
            </td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <div class="code">
    &lt;expected level="TEXT" /&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts" id="RestReplay-restReplay.testGroup.test.response.parts"></a>/restReplay/testGroup/test/response/parts</td>
          </tr>

          <tr>
            <td>parts</td>

            <td>Optional container for part elements. Required if more than one part element.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part" id="RestReplay-restReplay.testGroup.test.response.parts.part"></a>/restReplay/testGroup/test/response/parts/part</td>
          </tr>

          <tr>
            <td>part</td>

            <td>A template containing the schema part expected from the server, as opposed to the actual part sent from the server.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.label" id="RestReplay-restReplay.testGroup.test.response.parts.part.label"></a>/restReplay/testGroup/test/response/parts/part/label</td>
          </tr>

          <tr>
            <td>label</td>

            <td>The name of the schema, such as "objectexit_common", or "collectionspace_core".</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.f..." id="RestReplay-restReplay.testGroup.test.response.parts.part.f..."></a>/restReplay/testGroup/test/response/parts/part/filename</td>
          </tr>

          <tr>
            <td>filename</td>

            <td>The filename of the template for comparing to what the server sent.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.var" id="RestReplay-restReplay.testGroup.test.response.parts.part.var"></a>/restReplay/testGroup/test/response/parts/part/var</td>
          </tr>

          <tr>
            <td>var</td>

            <td>A variable declaration to be passed into the template.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>ID defines the variable name that will appear in the expression context, and the text of the var node will be evaluated just prior to comparing the template to the response from the server.</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>The file named in /restReplay/testGroup/test/response/part/filename is a template, which may contain variables.<br>
              Those variables should be defined in var child elements at this level. This keeps complicated variables<br>
              out of the template file and in the <b>control</b> file. Templates should just expose simple variables, such as ${depositor}<br>
              and not complicated variables that dig into the objects in the namespace, e.g. this would be considered bad form<br>
              if found inside a template file:</p>

              <div class="code">
    &lt;!-- DON'T DO THIS IN TEMPLATE FILE --&gt;
    &lt;shortIdentifier&gt;${test2.sent("pa_com","//sid")}&lt;/shortIdentifier&gt;
              </div>

              <p>It would be better to defined that variable in the <b>control</b> file, and then pass that single variable into the template.<br>
              e.g. define this in the template file "objectexit/res/test2GET.res.xml"</p>

              <div class="code">
    &lt;shortIdentifier&gt;${sid}&lt;/shortIdentifier&gt;
              </div>

              <p>then instantiate that variable in the <b>control</b> file:</p>

              <div class="code">
    &lt;response&gt;
      &lt;expected level="TEXT" /&gt;
      &lt;part&gt;
        &lt;label&gt;t2_com&lt;/label&gt;
        &lt;filename&gt;objectexit/res/test2GET.res.xml&lt;/filename&gt;
        &lt;var ID="shortIdentifier"&gt;${test2.sent("pa_com","//id")}&lt;/var&gt;
      &lt;/part&gt;
    &lt;/response&gt;
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <h4><a name="RestReplay-2.c.4Cleanup" id="RestReplay-2.c.4Cleanup"></a>2.c.4 Cleanup</h4>

      <p>After the testGroup has run, RestReplay will perform cleanup. You may control cleanup via the "autoDeletePOSTS" attribute of "testGroup". If true,<br>
      then any POSTs that returned a "Location: " header will result in RestReplay sending a DELETE on that Location: URL. If false, RestReplay<br>
      will perform no automated cleanup for that testGroup. If you called RestReplay programmatically, then you may initiate cleanup manually by calling<br>
      on these methods of org.dynamide.restreplay.RestReplay</p>

      <div class="code">
    public List&lt;ServiceResult&gt;  autoDelete(String logName);
      </div>

      <p>or</p>

      <div class="code">
    public static List&lt;ServiceResult&gt; autoDelete(Map&lt;String, ServiceResult&gt; serviceResultsMap, String logName);
      </div>
    </div>
  </div>
<script>
    debugger;
    var tm = document.getElementById("TOCMASTER");
    var tt = document.getElementById("TOCTEST");
    var d1 = document.getElementById("TOCDEST1");
    d1.innerHTML = tm.innerHTML;
    var d2 = document.getElementById("TOCDEST2");
    d2.innerHTML = tt.innerHTML;
</script>


</body></html>