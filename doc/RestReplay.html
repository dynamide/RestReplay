<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html; charset=us-ascii" http-equiv="content-type">






  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.12), see www.w3.org">
  

  <title>RestReplay</title>
  <style type="text/css">
  h1, h2, h3, h4, h5 {
    font-family: Helvetica, 'San Serif';
      margin-top: 20px;
      border-bottom: 1px solid black;
      
  }
    .main-toc h1 {
      margin:8px;
      margin-left: 0px;
      border-bottom: none;
    }
    .main-toc h2 {
      margin: 5px;
      margin-left: 10px;
      border-bottom: none;
    }
    .main-toc h3 {
      margin: 3px;
      margin-left: 20px;
      border-bottom: none;
    }
    .main-toc h4 {
      margin: 2px;
      margin-left: 30px;
      border-bottom: none;
    }
    
    
  td a {
    font-weight: bold;
  }
  CODE {
      padding: 3px;
      margin: 2px;
      display: inline-block;
      border: 1px solid gray;
      border-radius: 5px;
      background-color: rgb(240, 250, 240);
      }

  .mojonixon {
    padding-left: 20px;
    border: none;
  }
  .element-hdr, .pathrow {
    font-size: 100%; line-height: 13pt; color: rgb(51, 51, 51); font-weight: bold; background-image: none; background-color: rgb(173, 216, 230);
  }
  .code {
      font-size: 90%;
    white-space: pre;
    font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
    border: 1px dashed rgb(187, 187, 187); margin: 0px 0px 10px; 
    padding: 10px;
    overflow: auto; color: black; 
    hidebackground-color: rgb(220, 240, 220);
    background-color: rgb(240, 250, 240);
  }
  .panel {
    border: 1px dashed rgb(187, 187, 187); margin: 0px 0px 10px; padding: 0px; overflow: auto; color: black; 
    background-color: rgb(240, 240, 240);   
  }
  .comments {
      font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
      font-weight: normal;
      font-style: normal;
      font-size: 110%;
      color: rgb(0, 130, 0);
  }
    
  .public {
      color: blue;
  }
  .note1 {
      color: brown;
      font-weight: bold;
  }

      .matrix {
          border: 0px solid gray;
          border-spacing: 3px;
      }
      .matrix th {
          padding: 5px;
          font-family: Helvetica, 'Sans Serif';
          font-size: 80%;
          border: 0px solid gray;
          background-color: #b0c8c0;
      }
      .matrix td {
          font-family: Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace;
          margin: 5px;
          padding: 4px;
          border: 1px solid gray;
          background-color: #eee;
      }
      .matrix th {
          text-align: left;
      }
  #content {
      width: 95%;
      margin: 20px;
      border: 0px solid green;
  }
  .cheatsheet-body {
      border: 1px solid green;
      background-color: rgb(220, 240, 220);
  }
  #TOCDEST1 {
      width: 48%;
      font-size: 90%;
      float: left;
      margin-right; 0px;
  }
  #TOCDEST2 {
      font-size: 90%;
      width: 48%;
      float: right;
      margin-left: 0;
      }
  div.container {
      padding: 10px;
      border: 1px solid #000000;
      overflow: auto;
      width: 100%;
      background-color: #b0c8c0;
  }
  .cheatsheet-header {
      background-color: #b0cfc0;
      border-bottom: 1px solid green;
      padding: 6px;
      font-weight: bold;
      font-size: 90%;
      font-family: Helvetica, 'San Serif';
      text-align: center;
  }
  .main-toc {
      margin-top: 20px;
      font-size: 70%;
      padding: 20px;
      border: 1px solid black;
      background-color: lightblue;
      display: inline-block;
  }

  </style>
  
  <script src="js/syntaxhighlighter_3.0.83/scripts/shCore.js" type="text/javascript"></script>
  <script src="js/syntaxhighlighter_3.0.83/scripts/shBrushJScript.js" type="text/javascript"></script>
  <script src="js/syntaxhighlighter_3.0.83/scripts/shBrushXml.js" type="text/javascript"></script>
  <link href="js/syntaxhighlighter_3.0.83/styles/shCore.css" rel="stylesheet" type="text/css">
  <link href="js/syntaxhighlighter_3.0.83/styles/shThemeDefault.css" rel="stylesheet" type="text/css">

</head>

<body>
  <div id="content" class="page view">
    <div class="wiki-content">
      
    <h1><a name="RestReplay-RestReplayDocumentation" id="RestReplay-RestReplayDocumentation"></a>RestReplay Documentation</h1>
      <div class="container" style="width: 90%; margin: 50px;">
        <center>
        <h2>RestReplay Quick Reference</h2></center>
        <div id="TOCDEST1" class="cheatsheet-body">&nbsp;</div>
        <div id="TOCDEST2" class="cheatsheet-body">&nbsp;</div>
    </div>

    <span class="main-toc">
    <h2><a href="#RestReplay-1.Introduction">1. Introduction</a></h2>
    <h3><a href="#RestReplay-1.a.Features">1.a. Features</a></h3>
    <h3><a href="#RestReplay-1.bOverview">1.b Overview</a></h3>
<h3><a href="#RestReplay-1.c.Concepts">1.c Concepts</a></h3>
<h4><a href="#1.c.1.Expressions">1.c.1 Expressions</a></h4>
<h4><a href="#1.c.2.ValuesInContexts">1.c.2 Values in Contexts</a></h4>
<h4><a href="#1.c.3.CommonUsefulMethodsInContexts">1.c.3 Common Useful Methods in Contexts</a></h4>
<h4><a href="#1.c.4.Vars">1.c.4 Vars</a></h4>
<h4><a href="#1.c.5.Headers">1.c.5 Headers</a></h4>
<h4><a href="#1.c.6.Expected.Codes">1.c.6 Expected Codes</a></h4>
<h4><a href="#1.c.7.Mutators">1.c.7 Mutators</a></h4>
<h4><a href="#1.c.8-Looping">1.c.8 Looping</a></h4>
<h4><a href="#1.c.9.AutoDelete">1.c.9 AutoDelete</a></h4>      
      
    <h4><a href="#RestReplay-1.d.1Runtime">1.d.1 Runtime</a></h4>

    <h2><a href="#RestReplay-2.ReferenceDocumentation">2. Reference Documentation</a></h2>
    <h3><a href="#RestReplay-2.a.Installation">2.a. Installation</a></h3>
    <h3><a href="#RestReplay-2.b.Configuration">2.b. Configuration</a></h3>
    <h4><a href="#RestReplay-2.b.1GeneralRules">2.b.1 General Rules</a></h4>
    <h3><a href="#RestReplay-2.cRunning">2.c Running</a></h3>
    <h4><a href="#RestReplay-2.c.1Commandlineparameters">2.c.1 Command-line parameters</a></h4>
    <h4><a href="#RestReplay-2.c.2XMLconfigurationparametersinmasterfile">2.c.2 XML configuration parameters in <b>master</b> file</a></h4>
    <h4><a href="#RestReplay-2.c.3XMLconfigurationparametersincontrolfile">2.c.3 XML configuration parameters in <b>control</b> file</a></h4>
    <h4><a href="#RestReplay-2.c.4Cleanup">2.c.4 Cleanup</a></h4>
    <h2><a href="#RestReplay-3.Examples">3. RestReplay Examples</a></h2>
    <h3><a href="#RestReplay-3.a.1.DELETE">3.a.1 Using DELETE for lists of resources.</a></h3>
    <h3><a href="#RestReplay-3.a.2.XPath">3.a.2 Using XPath to dig elements out of XML or JSON.</a></h3>
    <h3><a href="#RestReplay-3.a.3.XPath">3.a.3 Using XPath part 2</a></h3>
    <h3><a href="#RestReplay-3.a.4.JexlScript">3.a.4 Jexl Script</a></h3>
    <h3><a href="#RestReplay-3.a.x.MoreExamples">3.a.x More Examples</a></h3>
    </span>
    

    <h2><a name="RestReplay-1.Introduction" id="RestReplay-1.Introduction"></a>1. RestReplay Introduction</h2>

      <p><span class="Apple-style-span">RestReplay is a utility to send REST requests to the services layer (including JSON, XML, and multipart XML requests), read responses, and compare<br>
        the resulting payloads with templates.&nbsp; <br></span></p>
<p><span class="Apple-style-span">At the end of a run, RestReplay produces a report, such as this </span><span class="Apple-style-span"><a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">self-test sample report</a>, which shows you a summary and detail of all the calls to your services layer.&nbsp; The reports have both a high-level view for administration and monitoring, and a low-level view useful for debugging issues or communicating results to developers or QA.<br></span></p>
<p><span class="Apple-style-span">RestReplay was designed to fit into Continuous Integration tools such as Maven and Jenkins.&nbsp; You can run RestReplay continuously, for service layer monitoring.&nbsp; Developers can run RestReplay during a developer build, and Build Administrators can run RestReplay on commit, tag, or push events, to ensure a build produces a services layer that survives integration testing.<br></span></p>
<p><span class="Apple-style-span">RestReplay is designed for simple, file-based, <a href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a> configuration, that is programmable by beginning programmers.<em> (It also has APIs for advanced users who wish to drive the tests from Java, or extend test types by writing plugins.)</em>&nbsp; For most users, however, look through our </span><span class="Apple-style-span"><span class="Apple-style-span"><a href="https://github.com/dynamide/RestReplay/tree/master/src/main/resources/restreplay/_self_test">self-test source code</a> </span>for full examples of running tests, chaining tests, looping tests, and validating result IDs.&nbsp; RestReplay is also designed to be configured many ways, for many kinds of projects.&nbsp; A good, safe bet is to follow the style in our self-test.&nbsp; See: <a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">self-test sample report</a> and <a href="https://github.com/dynamide/RestReplay/tree/master/src/main/resources/restreplay/_self_test">self-test source code</a>. <br></span></p>
<p><span class="Apple-style-span">All configuration parameters are covered below, in the order of the configuration XML files, after the discussion of the command line.&nbsp; You can use the handy links in the Quick Reference cards on this page to jump to the different elements to read syntax and examples.<br></span></p>
<p><span class="Apple-style-span">RestReplay lets you automate entire workflows over your REST layer.&nbsp; You can automate tests to login, request resources and APIs, extract data from the response, such as resource IDs, and use these IDs in subsequent tests.&nbsp; For example, each of these would be a test within one testGroup called OrderFlow:&nbsp; <br></span></p>
<ul>
<li><span class="Apple-style-span">OrderFlow<br></span></li>
<ul>
<li><span class="Apple-style-span">POST to login,<br></span></li>
<li><span class="Apple-style-span">PUT a new order and extract the ID returned, <br></span></li>
<li><span class="Apple-style-span">GET the latest list of orders,</span></li>
<li><span class="Apple-style-span">GET the invoice for the order ID, <br></span></li>
<li><span class="Apple-style-span">DELETE the order, <br></span></li>
<li><span class="Apple-style-span">GET the order to make sure it is gone.&nbsp; <br></span></li></ul></ul>
<p><span class="Apple-style-span">RestReplay executes the tests in this order you specify, and lets you pass variables in and out of each test.&nbsp; Each test can also have a small bit of code to count json arrays, dig in with jsonp or XPath, etc.&nbsp; </span><span class="Apple-style-span"><span class="Apple-style-span">These are documented below.</span></span></p>
<p><span class="Apple-style-span"><span class="Apple-style-span"></span>Most things are done for you by the framework, so you just specify the URL, the type of request, and create files for any POST or upload content, and hit Go!&nbsp; RestReplay runs your request, and&nbsp;</span><span class="Apple-style-span"><span class="Apple-style-span"> <a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">reports </a></span>on the result.&nbsp; Many times, success in testing and monitoring is just knowing that a particular sequence of HTTP transactions succeeded.&nbsp;&nbsp; For these kinds of testing, there is no programming.&nbsp; You'll merely replace values with variables that you define, such as ${ORDER_ID}, as you wire the tests together.&nbsp; <br></span></p>
<p><span class="Apple-style-span">Using the examples in our <a href="https://github.com/dynamide/RestReplay/tree/master/src/main/resources/restreplay/_self_test">self-test</a>, the documentation below, the <a href="http://commons.apache.org/proper/commons-jexl/reference/syntax.html">Jexl Documentation</a>, and our <a href="http://dynamide.org/RestReplay/javadoc/">Javadoc</a>, you can also program RestReplay to do more complicated workflows. <br></span></p>

      <h3><a name="RestReplay-1.a.Features" id="RestReplay-1.a.Features"></a>1.a. Features</h3>

      <ul>
        <li>Completely configurable via XML.</li>

        <li>Abstracts each transaction with server as a "test".</li>
<li>Tests are easily configured to: </li>
<ul>
<li>loop a number of times</li>
<li>re-run over a list of values for one variable, or multiple variables</li>
<li>mutate requests to send automatically variable data such as dates</li>
<li>mutate requests to remove required and optional fields to test service schema compliance</li></ul>
<li>All request payloads and expected response payload templates are stored as files within the deployed test.</li>

        <li>Multiple tests can be grouped in a testGroup element, and each test may refer to previous tests within testGroup.&nbsp; </li>
<li>This naturally models workflows from UX hitting a&nbsp; REST services layer, e.g. a resource is created in one test, then its ID, available in the response, is used by the next test to modify that resource.</li>
<li>TestGroups are run by Master control files, which let you centralize environments, e.g. testing against dev, qa, production.</li>

        <li>Optional Automatic cleanup of resources allocated within a testGroup.</li>

        <li>Send and receive JSON and XML payloads or MIME-multipart payloads.</li>
<li>Variable expansion in: URLs, headers, request payloads, and response payloads.</li>
<li>Javascript(Rhino) and Jexl2 for scripting and expression evaluation.</li>

        <li>Simple reporting of results on console and in surefire reports.</li>
<li>Full reporting of results in html <span class="Apple-style-span"><a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">report</a></span> output directory.</li>

        <li>Java programmatic interface for driving the tests and testGroups, and for finer control of reporting and cleanup.</li>
      </ul>

      <h3><a name="RestReplay-1.bOverview" id="RestReplay-1.bOverview"></a>1.b Overview</h3>
<p>RestReplay is run from the command line (or ant, maven, or Jenkins).&nbsp; It reads your configuration files, and along with startup parameters, determines which testGroups and which tests to run.&nbsp; Along the way, it initializes and evaluates any variables you have set up, such as hosts, ports, resource IDs, logins, and so on.&nbsp; </p>
<p>It runs the tests in the order you define, synchronously.&nbsp; As each test is run, it exports variables which become available to subsequent tests.&nbsp; Also after each test, the response is evaluated for schema correctness, and any Validator you have defined can run using Jexl or Javascript code. Read more about the runtime workflow at <a href="#RestReplay-1.d.1Runtime">1.d.1 Runtime</a>.</p>
<p>So you can think of it following stories, or use cases, or workflows, exercising your services layer.&nbsp; </p>
<p>After the tests have run, RestReplay compiles a directory of stand-alone reports that drill down from your high level view (the Master) to the detail view (the individual testGroup/test reports).&nbsp; Tweaking the RunOptions gives you control over the output on the command line, and also in the HTML report.&nbsp; These reports do not depend on anything else, and can be archived, since they show stats, results, documentation of your APIs, and contain all the input and output payloads.&nbsp; <span class="Apple-style-span">See: <a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">self-test sample report</a> </span></p>
<p>After the tests have run, you can check the code coverage of your services layer with external tools such as <a href="http://www.eclemma.org/">EclEmma / JaCoCo</a>, and also use other queries to check the state of your datastores.&nbsp; </p>
<p>RestReplay tests your services, but it also drives them exactly as a user or bot would, so think of the next steps in your integration testing.</p>
<h3><a name="RestReplay-1.c.Concepts"></a>1.c Concepts</h3>
<p>See the <a href="#RestReplay-2.ReferenceDocumentation">Reference Documentation</a> for syntax, structure, discussion, and examples of code.&nbsp; This section covers concepts that are common to many of the configurable and scriptable elements documented in the <a href="#RestReplay-2.ReferenceDocumentation">Reference Documentation</a>.</p>
<h4><a name="1.c.1.Expressions"></a>1.c.1 Expressions</h4>
<p>Expressions are defined using <a href="http://commons.apache.org/proper/commons-jexl/reference/syntax.html">Jexl syntax</a>. </p>
<p>Expressions are always evaluated in a context. <em>(Actually, a series of nested contexts, similar to Javascript scoping.&nbsp; RestReplay automatically provides these contexts, for each testGroup, eachTest, and each evaluation.)&nbsp;</em> Some values and tools will always be <a href="#1.c.2.ValuesInContexts">available in the context</a>, such as "kit", "tools", and "this".&nbsp; For running tests, all previously run tests are available, by ID, in the context.&nbsp; So any value sent to or received from a service, either from URLs, Headers, or payloads, can be retrieved using an expression.&nbsp; You can place values into the context with the <a href="#1.c.4.Vars">var</a> element.</p>
<p>An expression is evaluated just before it is used.&nbsp; (Subsequent evaluations use the latest values available from referenced data sources.) An expression in a test will not be evaluated until that test is run.&nbsp; Expressions stored elsewhere and referenced (such as Master vars, and headers) are also evaluated just as the test is run.&nbsp;&nbsp; Exported vars are evaluated after the test is run, and retain their values for the rest of the run through the testGroup.</p>
<p>Expressions are strings.&nbsp; They are surrounded by bash-like braces: ${ORDER_ID}&nbsp; looks up the value of the expression ORDER_ID.&nbsp; If ORDER_ID is defined in the "context" then its value is returned.&nbsp; Say ORDER_ID is set to a string: "abc123" , then the expression's value is like so: </p>
<table class="matrix" border="1" cellpadding="2" cellspacing="0">
<tbody>
<tr>
<th>expression</th>
<th>value</th></tr>
<tr>
<td>${ORDER_ID}</td>
<td>abc123</td></tr></tbody></table>
      <p>Now we could use this value in an expression to get a resource by URL:</p>
 <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[     <uri>http://example.com/query?order_id=${ORDER_ID}</uri>]]></script>
      <p>and RestReplay will hit the service:</p>
      <script type="syntaxhighlighter" class="brush: xml; gutter: false;"><![CDATA[     http://example.com/query?order_id=abc123]]></script>
<p>You can also have more complicated expressions, like:</p>
<script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
  <var ID="DAYS">${24*60*60*1000}</var>
  <var ID="BASE_DATE">${tools.now()}</var>
  <var ID="DUE_DATE_MILLIS">${BASE_DATE +0 * DAYS}</var>
  <var ID="DueDate">Due ${kit.dates.getMonthName(BASE_DATE)} ${kit.dates.getDayOfMonth(BASE_DATE)}</var>
  <var ID="VarTestMessage">Base message set here as default.</var>
]]></script>
    <p>These expressions were used in <a href="#1.c.4.Vars">vars, explained here</a></p>
  <p>See also: <a href="#RestReplay-3.a.4.JexlScript">3.a.4 Jexl Script</a> for an example of using a more complicated Jexl expression.</p>
    
<h4><a name="1.c.2.ValuesInContexts"></a>1.c.2 Values in Contexts</h4>
<p>In Jexl Expressions</p>
<p>
<table class="matrix">
                    <tbody>
<tr><th>serviceResult</th>
<td>  <a href="http://dynamide.org/RestReplay/javadoc/org/dynamide/restreplay/ServiceResult.html">org.dynamide.restreplay.ServiceResult</a>  - also stored as "this". Contains all vars and results, as well as IDs, timing, stati, etc.</td></tr> 
<tr><th>this</th>
<td>  <a href="http://dynamide.org/RestReplay/javadoc/org/dynamide/restreplay/ServiceResult.html">org.dynamide.restreplay.ServiceResult</a>  - also stored as "serviceResult". </td></tr> 
                    <tr><th>serviceResultsMap</th>
<td>  Map&lt;String, org.dynamide.restreplay.ServiceResult&gt;  - a map of all previously run tests in this same testGroup, kept in insertion order of the tests run.
                    Key is the ID of the test element.</td></tr> 
                    <tr><th>tools</th>
<td>  <a href="http://dynamide.org/RestReplay/javadoc/org/dynamide/util/Tools.html">org.dynamide.util.Tools</a></td></tr>
                    <tr><th>kit</th>
<td style="height: 19px;">  <a href="http://dynamide.org/RestReplay/javadoc/org/dynamide/restreplay/Kit.html">org.dynamide.restreplay.Kit</a></td></tr>
                    <tr><th>this.mutator.getIndex()</th>
<td> - zero-based index of which mutation loop this is.</td></tr>
                    <tr><th>__FILE__</th>
<td> String name of the validator file. (only avaliable in validators)</td></tr>
<tr>
<th>this.LoopIndex</th>
<td>If this test is run as a loop, then you can know the zero-based loop index by calling  <b>this.LoopIndex</b> </td></tr>
                </tbody></table>
      </p>

<p>Javascript contexts get the same objects.&nbsp; Additionally, the following methods are useful in javascript.&nbsp; Note that "<strong>this</strong>" in Javascript is NOT the <strong>serviceResult</strong>.</p>
<p>
      <table class="matrix">
                    <tbody>
<tr><th>kit.newStringArray(int)</th>
<td>  
<pre>var stringArray = kit.newStringArray(r.count);
for (var i=0; i&lt;r.count; i++){
    stringArray[i] = r.orders[i].order_id;
}</pre>
      </td></tr> 
                    <tr><th>serviceResult.result</th>
<td>  The body of the response.  If it is JSON, you can turn it into a javascript object with:
  






















<pre>var r = JSON.parse(serviceResult.result);</pre>
      
      
      
      
      
      
      </td></tr> 
                    <tr><th><br></th>
<td style="height: 18px;">  <br></td></tr>
                    <tr><th>serviceResult.mutator.getIndex()</th>
<td>  zero-based index of which mutation loop this is.</td></tr>
                    <tr><th>serviceResult.mutator.getMutationId()</th>
<td> Unique string name of this mutation, formatted by the mutator.</td></tr>
                    <tr><th><br></th>
<td><br></td></tr>
<tr>
<th><br></th>
<td><br></td></tr>
                </tbody></table>
      </p>
<h4><a name="1.c.3.CommonUsefulMethodsInContexts"></a>1.c.3 Common Useful Methods in Contexts</h4>
<p>Note that the variable named "<b>this"</b> is equivalent to <b>serviceResult</b> in the following examples, e.g. these two statements are identical: </p>
<ul>
<li><strong>this</strong>.addExport("myexport", "Foo Bar") </li>
<li><strong>serviceResult</strong>.addExport("myexport", "Foo Bar").</li></ul>
<p>
      <table class="matrix">
                    <tbody>
<tr><th>this.addExport(key,value)</th>
<td>  Creates a var as an export, available to subsequent tests.<br>Exports added with this.addExport() get tracked automatically if called from a Validator, and the 
list of exports added per validator is shown in the detail report as an 
Alert 
                from the validator.  The values of these exports can 
then be seen in the variables row (exports are a different background 
color--see Legend at bottom of page).<br>See the discussion under <a href="#RestReplay-3.a.1.DELETE">3.a.1.DELETE</a> for an example of using addExport().</td></tr>
                    <tr><th>this.testID</th>
<td>  <br></td></tr> 
                    <tr><th>this.testGroupID</th>
<td style="height: 18px;">  <br></td></tr>
                    <tr>
<th>this.testIDLabel</th>
<td><br></td></tr>
<tr>
<th>this.idFromMutator</th>
<td><br></td></tr>
<tr>
<th>this.fullURL</th>
<td><br></td></tr>
<tr>
<th>this.deleteURL</th>
<td><br></td></tr>
<tr><th>this.mutator.getIndex()</th>
<td>  zero-based index of which mutation loop this is.</td></tr>
                    <tr><th>this.mutator.getMutationId()</th>
<td> Unique string name of this mutation, formatted by the mutator.</td></tr>
                    <tr><th>  this.mutationID</th>
<td>Same as this.getMutationId()</td></tr>
<tr>
<th>kit.dates.*</th>
<td><br></td></tr>
                </tbody></table>




<p>You may specify that a test should loop. You supply either the <b>loop=""</b> attribute, or the <b>&lt;loop></b> element,
    with an expression that returns a number, an array, a Collection, or a Map
    (see <a href="http://dynamide.org/RestReplay/reports/_self_test/self-test.xml-Loops.html">Loop examples</a>)
    The loop value is a Jexl expression, or an integer.
    For example:
    <ul>
        <li>10</li>
        <li>${['a', 'b', 'c']}</li>
        <li>${{'key-a':'a', 'key-b':'b',  'key-c':'c']}</b></li>
        <li>${[200, 404, 202]}</b></li>
        <li>${otherTest.exportedVarCollection}</b></li>
        <li>${[{'a':'aVal', 'b':'bVal'},{'c':'cVal', 'd':'dVal'}]}</b></li>
    </ul>
    <br />
    The last example is an array of maps.  Each of the maps becomes loop.value.  So you could access the value for key "a" like this:
    <b>${loop.value.a}</b>
    <br />
    <br />
    RestReplay loops the test over the range you provide, and for each iteration, makes the following values available
    in contexts for evaluation of filenames, vars, headers, and validators.  Javascript validators also get these values via the
    global namespace.  In both javascript and jexl, the names of the variables are shown in the table.
    </p>
    <table class="matrix">
        <tbody>
        <tr><th>loop</th>
            <td> A loop object that has index, key, and value properties.  You may specify
                an array of String, an array of Object, a Collection, or a Map. (see <a href="http://dynamide.org/RestReplay/reports/_self_test/self-test.xml-Loops.html">Loop examples</a>)
                If the loop expression evaluates to one of these, the variables below apply.
            </td>
        </tr>
        <tr><th>loop.index</th>
            <td>The loop index number of this iteration, zero-based.  So if you specify loop="3", the
                test will be run three times, with the values of loop.index being: 0, 1, and 2.
            </td>
        </tr>
        <tr><th>loop.key</th>
            <td>If the loop expression returns a map like <b>{"a":"a value","b":"b value"}</b>, then
                the test will be run twice.  On the first iteration, loop.index=0, loop.key="a", and loop.value="b value".
                Then, on the second iteration, when loop.index=1, loop.key will be "b", and loop.value will be "b value".
            </td>
        </tr>
        <tr><th>loop.value</th>
            <td>
                If the loop object is an array, the loop.value will be the array element at the index loop.index.
                For a map, the value is the value for the current key, available in loop.key.
                RestReplay evaluates these for you,
                <pre>
For maps:
   loop.value == loop[loop.key]
For arrays:
   loop.value == loop[loop.index]
                    </pre>
            </td>
        </tr>
        <tr><th>loop.object</th>
            <td>Set if the loop expression returns an object.  Will probably be a Map, Array, or Collection.
            </td>
        </tr>
        </tbody></table>

    See the many test cases in the <a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">self-test</a> that use looping and vars.
    Specifically, see this testGroup: <a href="http://dynamide.org/RestReplay/reports/_self_test/self-test.xml-Loops.html">Loops</a>, which uses looping and vars.





      </p>
<h4><a name="1.c.4.Vars"></a>1.c.4 Vars</h4>
<p>The vars/var tag appears in several places in the configuration file trees.<br>They use the same rules discussed under <a href="#RestReplay-restReplay.testGroup.vars.var">/restReplay/testGroup/vars/var</a>.</p>
<p>Vars in different xml config elements have different scoping rules.</p>
<p>Here are the places vars can exist:</p>
<p>&nbsp;&nbsp;&nbsp; <a href="#RestReplay-restReplay.testGroup.vars.var">/restReplay/testGroup/vars/var</a><br>&nbsp;&nbsp;&nbsp; <a href="#RestReplay-restReplay.testGroup.test.vars.var">/restReplay/testGroup/test/vars/var</a><br>&nbsp; &nbsp;<a href="#RestReplay-restReplay.testGroup.test.exports.vars.var"> /restReplay/testGroup/test/exports/vars/var</a><br>&nbsp;&nbsp;&nbsp;<a href="#RestReplay-master.vars.var"> /restReplayMaster/vars/var</a><br>&nbsp;&nbsp;&nbsp;<a href="#RestReplay-master.envs.vars.var"> /restReplayMaster/env/vars/var</a></p>
<p> See also: <a href="#RestReplay-3.a.4.JexlScript">3.a.4 Jexl Script</a> for an example of using a more complicated Jexl expression as a var.</p>
<p>Here is the list of vars shown above in the discussion on <a href="#1.c.1.Expressions">1.c.1 Expressions</a>
<script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
<vars>
  <var ID="DAYS">${24*60*60*1000}</var>
  <var ID="BASE_DATE">${tools.now()}</var>
  <var ID="DUE_DATE_MILLIS">${BASE_DATE +0 * DAYS}</var>
  <var ID="DueDate">Due ${kit.dates.getMonthName(BASE_DATE)} ${kit.dates.getDayOfMonth(BASE_DATE)}</var>
  <var ID="VarTestMessage">Base message set here as default.</var>
</vars>
]]></script>
</p>


    <h4><a name="1.c.5.Headers"></a>1.c.5 Headers</h4>
<p>See: <a href="#RestReplay-restReplay.testGroup.headers.header">/restReplay/testGroup/headers/header</a></p>
<h4><a name="1.c.6.Expected.Codes"></a>1.c.6 Expected Codes</h4>
<p>See <a href="#RestReplay-restReplay.testGroup.test.expected.code">/restReplay/testGroup/test/expected/code</a></p>
<h4><a name="1.c.7.Mutators"></a>1.c.7 Mutators</h4>
<p>See <a href="#RestReplay-restReplay.testGroup.test.mutator">/restReplay/testGroup/test/mutator</a></p>
<h4><a name="1.c.8-Looping"></a>1.c.8 Looping</h4>
<p>You can loop tests two ways with RestReplay.&nbsp; First, you can use &lt;test ID="myLoopyTest" loop="2"&gt;...&lt;/test&gt; to loop a test.&nbsp; Of course, the value provided to the loop parameter can be a Jexl Expression, so you can run the loop a variable number of times: </p>
<p>&lt;test ID="deleteOrders" loop="${size(ordersListTest.ORDER_IDS)}"&gt;</p>
<p>See a full example in <a href="#RestReplay-3.a.1.DELETE">3.a.1 DELETE</a></p>
  <p>You can also loop using a <a href="#RestReplay-restReplay.testGroup.test.mutator">VarMutator.</a></p>






    <h4><a name="1.c.9.AutoDelete"></a>1.c.9 AutoDelete</h4>
<a href="#RestReplay-restReplay.testGroup">AutoDelete</a> is turned on with global parameters and testGroup parameters.<br><br>RestReplay keeps track of the<strong> Location</strong> header sent by services. This allows you to later delete that resource.&nbsp; Some services do not follow this pattern of returning a <strong>Location</strong> header after creating a resource with a POST, so RestReplay lets you define an expression for the DeleteURL.&nbsp; <br><br>If <a href="#RestReplay-restReplay.testGroup">AutoDelete</a>  is on for your testGroup, then if either of Location or DeleteURL are set, then at the end of a testGroup, then RestReplay will call DELETE on the Location or DeleteURL for every test that used POSTs.<br>








    <h4><a name="RestReplay-1.b.1Runtime" id="RestReplay-1.d.1Runtime"></a>1.d.1 Runtime</h4>

      <p>At runtime, RestReplay consults parameters passed in on the command line, or from maven surefire,
          or from java:exec which uses parameters found in the pom.xml project file under options for the <span style="font-style: italic; font-weight: bold;">exec-maven-plugin</span> plugin.</p>

      <p>RestReplay then determines which <b>master</b> file to use. This file points to <strong>testGroup</strong>s
          in <b>control</b> files that contain <strong>test</strong>s.</p>

      <p>The default behavior of RestReplay is to look for a directory, called the RestReplay directory.
          This is defined using<strong> -testdir</strong> parameter.</p>

      <p>When running inside maven surefire, this is pre-defined to be a resource directory in the source code module.
          Maven defines a variable called basedir, which points at the project directory for the current pom.xml. In the pom.xml
          file, you can point maven exec:java at the testdir (called "tests" in this example) like so:
      </p>
<div class="code panel">
        &lt;argument&gt;-testdir&lt;/argument&gt;
        &lt;argument&gt;${basedir}/tests&lt;/argument&gt;
      </div>

      See the full example of how to run maven's exec:java with command line parameters here:
    <a href="https://github.com/dynamide/RestReplay/blob/master/pom.xml">https://github.com/dynamide/RestReplay/blob/master/pom.xml</a>
      

      <p>Within the RestReplay directory, there are various <b>master</b> files, some control files, and directories for each service.
          You can select a particular master with the command line parameter -<strong>master</strong></p>

      <p>Most services should define their <b>control</b> file within their directory, e.g.</p>

      <div class="code panel">
      restreplay/master.xml                    <span class="comments">//the <b>master</b> file used by the nightly build.</span>
      restreplay/objectexit/                   <span class="comments">//the directory for a service called, say,  objectexit, <br>                                           //  with all its <b>control</b> files, and request/response templates.</span>
      restreplay/objectexit/object-exit.xml    <span class="comments">//the <b>control</b> file for this service, objectexit.</span>
      restreplay/objectexit/res/               <span class="comments">//a sub-directory to contain response templates.</span>
      </div>

      <p>For development, you may define your own master. See "<a href="#RestReplay-2.cRunning">2.c. Running</a>"<br>
      For integration testing, use the predefined <b>master</b> file called master.xml.</p>There is a test that checks the RestReplay installation itself.&nbsp; It lives in <br>&nbsp;&nbsp;&nbsp;&nbsp; _self_test/master-self-test.xml<br>

      <p>Within a <b>control</b> file, RestReplay finds testGroup elements as specified on the command line or in the <b>master</b> file, and then runs these testGroup elements.</p>

      <p>For each testGroup, a namespace is set up that will contain the results of all tests run in that testGroup, and any variables defined as the test runs. This namespace contains variables that dereference to java objects, so Strings, Date objects, etc. may be put into the namespace. For every test, RestReplay creates a named object of type org.dynamide.restreplay.ServiceResult, so that after that test has run, you may pull fields out of the ServiceResult object, such as responseCode, fullURL, location, and calculated fields such as from the <b>Location:</b> header.</p>

      <p>You may also use methods on the ServiceResult object that give you XPath access to any field in any part either sent or recieved from the server in that test.</p>

      <p>ServiceResult methods and fields:</p>

      <div class="code">
      public class ServiceResult ::

          <span class="comments">//dig into the schema part from the expanded request, identified by partName,</span>
          <span class="comments">//  and get the text value of node identified by path</span>
          public String sent(String partName, String path); //path is either <a href="http://www.w3schools.com/xpath/xpath_syntax.asp">XPath</a> or <a href="https://github.com/jayway/JsonPath/blob/master/README.md">JsonPath</a>.

          <span class="comments">//dig into the schema part returned by the server, identified by partName,</span>
          <span class="comments">// and get the text value of node identified by xpath </span>
          public String got(String partName, String path); //path is either <a href="http://www.w3schools.com/xpath/xpath_syntax.asp">XPath</a> or <a href="https://github.com/jayway/JsonPath/blob/master/README.md">JsonPath</a>.

          public String location <span class="comments">//the Location: header value of the resource, which is a full URL.</span>
      </div>
      <p>For each "<strong>test</strong>" node in a <strong>testGroup</strong>, RestReplay sets up a request, using the URI (which may contain expressions), the http method, and any parts specified for a POST or a PUT. The parts are read from text files in a directory relative to the RestReplay base directory, and may contain/define variables which get passed in. The value of these variables is evaluated in the <b>control</b> file just prior to the <strong>test</strong> node being run. So previous tests may be referenced. The parts are expanded for any expressions, and then put together in the appropriate http sequence and submitted to the server. The response from the server is then made available to the test to check using the "response" node. The "response" node allows you to specify a template file to compare, and any&nbsp; variables declared will be evaluated just prior to comparing the response from the server to the response template file.</p>

      <p>After the testGroup has run, RestReplay will perform cleanup. You may control cleanup via the "autoDeletePOSTS" attribute of "testGroup".</p>
<ul>
<li>
      If true, then RestReplay does a DELETE on each resource allocated.</li>
<li>
      If false, RestReplay does no automatic DELETEs.</li></ul>
<p>
      You may also programmatically call RestReplay, in which case you can programmatically control cleanup of individual tests. See "<a href="#RestReplay-2.c.4Cleanup">2.c.4 Cleanup</a>"</p>

      <p>Finally, results are aggregated and spit out to the command line console, and/or to reports. You can customize how verbose these results are using the "dump" node in the <b>master</b> file.&nbsp; Regardless of dump settings, all results go to the stand-alone html reports.</p>

      <p>If all <strong>testGroup</strong>s and all tests succeed, then RestReplay tells maven surefire that the suite succeeded. Otherwise, maven surefire is told that the suite failed. In this case, you may examine the console, or look at the maven surefire report, which will contain a tabular summary of all testGroups and tests. You may have to click "show all results" in the maven surefire report.</p>

      <p>RestReplay also creates a stand-alone report. Look at the command line output where RestReplay will report the location of this HTML report, e.g. something of this form:</p>
      <div class="code">    Master Report Index: ./tests/reports/index.local.las-master.xml.html </div>
      
      <p>This reports directory starts with an index file named after any <b>master</b> file you have run, which links to individual <b>control</b> file results.</p>

      
<h2><a name="RestReplay-2.ReferenceDocumentation" id="RestReplay-2.ReferenceDocumentation"></a>2. Reference Documentation</h2>

      <h3><a name="RestReplay-2.a.Installation" id="RestReplay-2.a.Installation"></a>2.a. Installation</h3>
      <p>RestReplay is downloaded as a jar, so you simply put this jar on your classpath and run it, with some options.
      Alternatively, you can integrate RestReplay into your Maven build.  To run it on Jenkins, just make RestReplay.jar available
      on the Jenkins job's classpath, and use the command line parameters.</p>

    <p>To see the structure of the testdir that will hold your tests, un-jar the RestReplay.jar file, and look for
     the subdirectory src/main/resources/restreplay/.  This is our -testdir.  In it we have defined a project
    called _self-test.  The _self-test project has working, precise tests that cover most of our functionality.  To
        write tests, you'll want to look at a body of tests, such as our _self-test which has great examples,
        and uses the organizational features of RestReplay.
        You should also have a -testdir, and have some organization that stores tests by groups that
    make sense for your project. Feel free to mimic the structure of _self-test.  But know that RestReplay
    can run this _self-test from the classpath, that is, from the copy inside the jar file.  So if you don't obscure the
    name _self-test, then you can always run our test suite on startup, which simply tests that everything works
    from RestReplay, over http to a local, temporary test service it spins up.  You can copy, and or override the _self-test to do your bidding if you need a custom setup.
    This works because the tests are found on your -testdir path first, and if not, are looked up from the jar file.
    In this same way, the reports use our CSS file, which you can override once you see the path from the jar file.
        So in our jar file is the resource
        <b>src/main/resources/restreplay/_includes/reports-include.css</b>, which you can override with a copy in your -testdir directory structure
        like so, where <b>TEST_DIR</b> is the directory where you have told RestReplay is the root of all your tests:
        <br><b>TEST_DIR/_includes/reports-include.css</b></p>

      <h3><a name="RestReplay-2.b.Configuration" id="RestReplay-2.b.Configuration"></a>2.b. Configuration</h3>

      <h4><a name="RestReplay-2.b.1GeneralRules" id="RestReplay-2.b.1GeneralRules"></a>2.b.1 General Rules</h4>

      <p>General Variable Syntax: starts with letter or underscore (_), contains letters, numbers, underscore. No other special characters, especially not the dollar-sign ($).</p>

      <p>For an ID attribute to be valid, please use General Variable Syntax.</p>

      <p>Element names should also follow the General Variable Syntax.</p>

      <p>General Filename syntax: please stick to General Variable Syntax plus hyphen (-) and period (.).</p>
<p>Filenames may contain the delimiter / to denote directories. These will be transformed into platform-specific directory separators.</p>

      <h3><a name="RestReplay-2.cRunning" id="RestReplay-2.cRunning"></a>2.c Running</h3>

      <p>You can run RestReplay on the command-line, or from the command-line of maven surefire.</p>
<p>To run from the command line, using a jar distribution, then this example would run the environment <b>local</b> using the directory <b>/.tests</b>
            for control files and will put reports in <b>/.tests/reports</b>.  From that directory, it will find the master
            control file, <b>master.xml</b> .</p>
        <div class="code">
       java -jar lib/RestReplay-1.0.4-standalone.jar \
            -testdir <b>./tests</b> \
            -master <b>master.xml</b> \
            -env <b>local</b>
        </div><p>This would run RestReplay, telling it where to find <strong>test</strong>s, and which <strong>master</strong> to run.&nbsp; It also passes in an environment ID, which selects per-environment settings from the master file's <a href="#RestReplay-master.envs">&lt;env&gt;</a> section.</p>
<p><br></p>
<p>To run using the maven surefire test, which will find <strong>_self_test/master-self-test.xml</strong> on the path or in the Jar file:</p>

      <div class="code">
    mvn -o install
      </div>
    <p>Or, to override the port that the self-test will open, use:</p>
      <div class="code">
    mvn -o install -Dport=29003
      </div>

<p>To run using the maven surefire test pointed at a master, e.g. master.xml in ./tests/, simply:</p>

      <div class="code">
    mvn -o install \<br>        -D-testdir=./tests \<br>        -D-master=master.xml
      </div>
<p>or define your own <b>master</b> file, which you create:</p>

      <div class="code">
    vi ./my-master-file.xml
    mvn test -Dmaster=my-master-file.xml \<br>             -DforkMode=never \<br>             -Dtest=myTestID
      </div>

      <h4><a name="RestReplay-2.c.1Commandlineparameters" id="RestReplay-2.c.1Commandlineparameters"></a>2.c.1 Command-line parameters</h4><br>
<table class="matrix" width="100%">
  <colgroup>
    <col style="width:8em;">
    <col style="width:10em;">
    <col style="width:100px">
  </colgroup>  
<tbody>
<tr>
<th>Option</th>
<th>Example command-line parameter</th>

<th>Notes</th></tr>
<tr>
<td>testdir</td>
<td>-testdir ./tests</td>

<td>The path to all the tests.</td></tr>
<tr>
<td>reports</td>
<td>-reports /mnt/reports</td>

<td>Specify output reports dir, default is "reports" relative to testdir</td></tr>
<tr>
<td>testGroup</td>
<td>-testGroup main</td>

<td>Run one testGroup when running with -control.</td></tr>
<tr>
<td>test</td>
<td>-test pitoken</td>

<td>The ID from a <a href="#RestReplay-restReplay.testGroup.test">test</a> element when running one control file.</td></tr>
<tr>
<td>env</td>
<td>-env local</td>

<td>One <a href="#RestReplay-master.envs">env</a> ID defined in your master file.</td></tr>
<tr>
<td>autoDeletePOSTS</td>
<td>-autoDeletePOSTS true</td>

<td>Override the setting from the commandline, but will NOT override setting in control files.</td></tr>
<tr>
<td>dumpResults</td>
<td>-dumpResults true</td>
<td>If you are not running a master, you can control dumps here.</td>
</tr>

<tr>
<td>control</td>
<td>-control my-control.xml</td>
<td>Run one control file, optionally without a master.  Requires at least <strong>testGroup</strong>, and also accepts <strong>test</strong>. If you
run with a master, then masterVars and master headers are pulled in first.  Otherwise, all vars and headers must run
stand-alone within the control file.</td>
</tr>

<tr>
    <td>master</td>
    <td>-master my-master.xml</td>
    <td>Run one master file.&nbsp; If this is set, and the option <strong>control</strong> is used, then <strong>testGroup</strong>, and <strong>test</strong> are used, otherwise
        <strong>testGroup</strong> and <strong>test</strong> are ignored.</td>
</tr>

<tr>
    <td>selftest</td>
    <td>-selftest</td>
    <td>Run the self-test.  If the default port conflicts on your system, override it with -port.  The self-test spins up a basic http server, and points
    the self-test at http://localhost:port where port is defined by the -port parameter, or uses its default.  At the end of the test, the server is stopped.</td>
</tr>

<tr>
    <td>port</td>
    <td>-port 8081</td>
    <td>Allows you to override the default port that the self-test opens.  Default is 28080</td>
</tr>


</tbody>
</table>


<br>When running in Maven, you must pass these command line parameters via the Java -D mechanism, using an = sign to set the value, e.g.<br><br>
      <div class="code">mvn exec:java -Dtestdir=./tests</div>
<p>Here are some more examples of running on the command line.</p>
<p>In this run, we are hitting the control file pi/pitoken.xml with no master file.&nbsp; So we specify testGroup, test within that control file.</p>
    
      <div class="code">java -jar lib/RestReplay-1.0.4-standalone.jar \<br> -testdir ./tests \<br> -control pi/pitoken.xml \<br> -testGroup main \<br> -test pitoken
      </div>
      <p><br></p>
<p>In this run, we are running with a -master and a -control, AND a -testGroup.&nbsp; This runs only that testGroup, but picks up vars and headers from the master.</p>
          <div class="code">java -jar lib/RestReplay-1.0.4-standalone.jar \<br>  -testdir ./tests \<br>  -master my-master.xml <br>  -control myservice/myservice.xml \<br>  -testGroup deleteAllWidgets
      </div>
      
<p><br></p>
<p>In this run, we are sending reports to a different directory (./myreports) than the default (tests/reports)</p>
      
      <div class="code">java -jar lib/RestReplay-1.0.4-standalone.jar \<br> -testdir ./tests \<br> -master master.xml \<br> -reports ./myreports
      </div>
      
<h4><a name="RestReplay-2.c.2XMLconfigurationparametersinmasterfile" id="RestReplay-2.c.2XMLconfigurationparametersinmasterfile"></a>2.c.2 XML configuration parameters in <b>master</b> file</h4>

      <p>Click on an element to jump to documentation for that element and its attributes.</p>



      <div id="TOCMASTER" class="cheatsheet-body">
      <div class="cheatsheet-header">Master control file</div>
      <pre>  &lt;<a href="#RestReplay-master">restReplayMaster</a>&gt;
      &lt;<a href="#RestReplay-master.dump">dump</a>/&gt;
      &lt;<a href="#RestReplay-master.auths">auths</a>&gt;
          &lt;<a href="#RestReplay-master.auths.auth">auth</a>&gt;
      &lt;/auths&gt;
      &lt;<a href="#RestReplay-master.runOptions">runOptions</a>&gt;
          &lt;connectionTimeout /&gt;
          &lt;socketTimeout /&gt;
          &lt;errorsBecomeEmptyStrings /&gt;
          &lt;acceptAlertLevel /&gt;
          &lt;failTestOnWarnings /&gt;
          &lt;failTestOnErrors /&gt;
          &lt;dumpResourceManagerSummary /&gt;
          &lt;skipMutators /&gt;
          &lt;outputServiceResultDB /&gt;
          &lt;condensedHeaders /&gt;
      &lt;/runOptions&gt;
      &lt;vars&gt;
          &lt;<a href="#RestReplay-master.vars.var">var</a> /&gt;
      &lt;/vars&gt;
      &lt;<a href="#RestReplay-master.envs">envs</a>&gt;
          &lt;<a href="#RestReplay-master.envs.vars">vars</a>&gt;
            &lt;<a href="#RestReplay-master.envs.vars.var">var</a> /&gt;
          &lt;/vars&gt;
      &lt;/envs&gt;
      &lt;<a href="#RestReplay-master.run">run</a> /&gt;
  &lt;/restReplayMaster&gt;</pre>
      </div>


              <table border="1" cellpadding="3" cellspacing="0">
        <tbody>
          <tr>
            <td colspan="3" class="pathrow element-hdr"><a name="RestReplay-master" id="RestReplay-master"></a>/restReplayMaster</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>
                dump<br>
                auths<br>
                runOptions<br>
                vars<br>
                envs<br>
                run<br>
            </td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.dump" id="RestReplay-master.dump"></a>/restReplayMaster/dump</td>
          </tr>

          <tr>
              <td>@dumpServiceResult</td>

              <td>auto - like detailed, but always shows payloads if there is an error<br>full - like detailed, but defaults to showing payloads<br>detailed - enough information to debug<br>minimal - a one-line display<br>
                  </td>
          </tr>

          <tr>
              <td>@payloads</td>

              <td>dumps payloads after summary result.</td>
          </tr>
          <tr>
              <td>Matrix:</td>

              <td>
                  <table class="matrix">
                      <tbody>
<tr>
                          <td><br></td><th>payloads true</th><th>payloads false</th>
                      </tr>
                      <tr>
                          <th>auto</th><td>detail + payloads</td>
<td>detail <b style="color:orange;">+payloads if error</b></td>
                      </tr>
                      <tr>
                          <th>full</th><td>detail + payloads</td>
<td>detail</td>
                      </tr>
                      <tr>
                          <th>detailed</th><td>detail</td>
<td>detail</td>
                      </tr>
                      <tr>
                          <th>minimal</th><td>minimal</td>
<td>minimal</td>
                      </tr>
                  </tbody></table>
              </td>
          </tr>


          <tr>
              <td>Example:</td>

              <td>
                  <br>
                  <div class="code">&lt;dump dumpServiceResult="detailed" payloads="false" /&gt;</div>
              </td>
          </tr>




          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.auths" id="RestReplay-master.auths"></a>/restReplayMaster/auths</td>
          </tr>

          <tr>
              <td><br></td>

              <td>A list of users and their related Base-64 encrypted<tt>username:password</tt>strings. You can generate these strings in number of
                  ways, among them by using the online utility at <a href="http://www.motobit.com/util/base64-decoder-encoder.asp" class="external-link" rel="nofollow">http://www.motobit.com/util/base64-decoder-encoder.asp</a>.</td>
          </tr>

          <tr>
              <td>@default</td>

              <td>the user ID to use if none is specified in the test</td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.auths.auth" id="RestReplay-master.auths.auth"></a>/restReplayMaster/auths/auth</td>
          </tr>

          <tr>
              <td>@ID</td>

              <td>a user ID</td>
          </tr>

          <tr>
              <td>element text</td>

              <td>Base-64 encrypted username:password to be used with "Basic Authentication" the same way a browser would.</td>
          </tr>

          <tr>
              <td>Example:</td>

              <td>
                  <p>Example:</p>

                  <div class="code">&lt;auths default="admin@example.org"&gt;
    &lt;auth ID="admin@example.org"&gt;dXNlcjFAbXVzZXVtMS5vcmc6dXNlcjFAbXVzZXVtMS5vcmc=&lt;/auth&gt;
    &lt;auth ID="bigbird2010"&gt;YmlnYmlyZDIwMTA6YmlnYmlyZDIwMTA=&lt;/auth&gt;
    &lt;auth ID="elmo2010"&gt;ZWxtbzIwMTA6ZWxtbzIwMTA=&lt;/auth&gt;
&lt;/auths&gt;                  </div>
              </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-master.run" id="RestReplay-master.runOptions"></a>/restReplayMaster/runOptions</td>
          </tr>

          <tr>
            <td>connectionTimeout</td>

            <td>Timeout for connecting to remote servers, in milliseconds.</td>
          </tr>
          <tr>
            <td>socketTimeout</td>

            <td>Timeout for data transfer, in milliseconds.</td>
          </tr>

          <tr>
            <td>errorsBecomeEmptyStrings</td>

            <td><code>boolean: true|false</code>  Set to true if you want undefined vars and errors in var syntax to become empty strings, otherwise they are left intact in the template.</td>
          </tr>

          <tr>
            <td>acceptAlertLevel</td>
            <td>A String without quotes, one of: OK, WARN, ERROR.&nbsp; (As defined in Alert.LEVEL enum.)  <br><i><b>[Not implemented.  When implemented, will abort the testGroup or Master run if Warnings or Errors occur in individual tests.]</b></i> </td></tr>
            <tr>
            <td>failTestOnWarnings</td>
            <td><code>boolean: true|false</code>&nbsp; Simply overrides display of SUCCESS to be FAILURE for a test if there are any warnings.&nbsp; Warnings come from things like variables that are not defined but are used in expressions.&nbsp; Does not abort testGroup or Master runs.</td></tr>
            <tr>
            <td>failTestOnErrors</td>
            <td><code>boolean: true|false</code> Simply overrides display of SUCCESS to be FAILURE for a test if there are any errors.&nbsp; Errors come from things like malformed expressions, files not found, socket timeouts on URLs, etc.&nbsp; Does not abort testGroup or Master runs.</td></tr>
            <tr>
            <td>dumpResourceManagerSummary</td>
            <td><code>boolean: true|false</code> The ResourceManager finds files in the classpath and the filesystem.&nbsp; The HTML report for the Master contains a listing of all resources searched for.&nbsp; This setting allows you to dump that list to the console, if true.</td></tr>
            <tr>
            <td>skipMutators</td>
            <td><code>boolean: true|false</code> All mutators in all tests will be skipped.&nbsp; Only the test will be run, and not any variations generated by the &lt;mutator&gt; set within the test.</td>
          </tr>

          <tr>
              <td>outputServiceResultDB</td>
              <td><p><code>boolean: true|false</code>  If true, RestReplay writes out a flat-file database of all ServiceResult
                  objects, serialized to JSON, in directories named after their control files, testGroups,
                  and directories in the test tree.  The root of the database is <code>${testdir}/db/</code></p>
                  <p><i>There is an experimental viewer for these in our source, in
                  <code>/src/main/resources/restreplay/_includes/service-result-handlebars-template.html</code>, which
                  ends up in the RestReplay jar file as </i> <code>_includes/service-result-handlebars-template.html</code>.</p>
              </td>
          </tr>

          <tr>
              <td>condensedHeaders</td>
              <td>Comma separated list of String.  Include any headers for which you want values condensed into comma-separated
                  header values when a duplicate header specification is seen in a test. This is standard for the header ACCEPT,
                  so that if you specify ACCEPT twice, say once in the testGroup, and once in a test, then <b>both</b> values
                  get sent with something like this: <code>Accept: application/json, text/json</code>.  You can override which headers
                  RestReplay will do this for.  By default, RestReplay comes with [ACCEPT, CONTENT-TYPE, COOKIE], which you can 
                  add to with one
                  <div class="code">&lt;condensedHeaders>X-FOOBAR&lt;/condensedHeaders></div>
                  or override with a blank list with
                  <div class="code">&lt;condensedHeaders>NONE&lt;/condensedHeaders></div>
                  or blank out then add a custom set:
                  <div class="code">&lt;condensedHeaders>NONE,COOKIE,X-FOOBAR&lt;/condensedHeaders></div>
              </td>
          </tr>

          <tr>
            <td>Example:</td>
            <td>
<div class="code"> &lt;runOptions&gt;
        &lt;connectionTimeout&gt;<strong>3000</strong>&lt;/connectionTimeout&gt;
        &lt;socketTimeout&gt;<strong>3000</strong>&lt;/socketTimeout&gt;
        &lt;errorsBecomeEmptyStrings&gt;<strong>true</strong>&lt;/errorsBecomeEmptyStrings&gt;
        &lt;acceptAlertLevel&gt;<strong>OK</strong>&lt;/acceptAlertLevel&gt;
        &lt;failTestOnWarnings&gt;<strong>true</strong>&lt;/failTestOnWarnings&gt;
        &lt;failTestOnErrors&gt;<strong>true</strong>&lt;/failTestOnErrors&gt;
        &lt;dumpResourceManagerSummary&gt;<strong>false</strong>&lt;/dumpResourceManagerSummary&gt;
        &lt;skipMutators&gt;<strong>false</strong>&lt;/skipMutators&gt;
        &lt;outputServiceResultDB&gt;<strong>false</strong>&lt;/outputServiceResultDB&gt;
        &lt;condensedHeaders&gt;<strong>X-FOO, X-BAR</strong>&lt;/condensedHeaders&gt;
    &nbsp;&lt;/runOptions&gt;

</div></td>
          </tr>


          <tr>
<td>Discussion:</td>
<td>
    <pre>{rest-replay-base-directory}/runOptions.xml is the best place to do site-wide settings for RestReplay.
It contains a &lt;<strong>runOptions</strong>&gt; root element.

All of these options can be controlled in a master file, too.
In this case, your master file contains &lt;<strong>runOptions</strong>&gt; under the root element &lt;<strong>restReplayMaster</strong>&gt;

When overriding RunOptions in a master file, consider these two development scenarios:
            1) you are developing locally, and are setting per-test cases while you run tests,
               and you may or may not check in your changes.
                  In this case, change any settings you like as close to the testCase as you can in the chain:
                        <strong>runOptions &gt; master &gt; testGroup &gt; testCase</strong>
                  But feel free to change runOptions.xml and your master file, which ever is easiest.<br>	          Before committing your code, validate that you no longer need those options, <br>                     or consider coordinating the change with the team, since these settings affect many tests.<br><br>            2) you are committing this master to source control, so that it gets picked up by automated builds.
                   In this case, you should have a reason, coordinated with your team, <br>                   for overriding the default file (runOptions.xml) or the master for each project.

    Options:
        "<strong>connectionTimeout</strong>"
        "<strong>socketTimeout</strong>"
            The most reasonable override in a master file's RunOptions is the timeouts:
            these may vary by service, or host
            so one clean organization of test would be by services
            or known clusters of hosts with particular timeouts.
            You could have one control file, say, "master-edge-services.xml",
            with one testGroup, "timeCriticalServices", and in that testGroup put all the services from,
            say, a time-critical cluster.  In that control file,
            set the RunOption timeouts to be low.  In the Master, set the timeouts to be more "normal".
            All the other tests will run with "normal", and tests in master-edge-services.xml
            in testGroup "timeCriticalServices" will run with low timeouts.

        "<strong>errorsBecomeEmptyStrings</strong>" would be set locally if you were debugging.

        "<strong>dumpResourceManagerSummary</strong>" should probably be best left
           to the central location in the file (runOptions.xml)
           since it controls output to the console.

        "<strong>skipMutators</strong>" will skip processing for Mutators.  Mutators take one test and replays it with modified payloads.


    The heirarchy is:
       RunOptions : class defaults
         runOptions.xml : default for all tests
           my-master.xml :  overrides properties for this master.
                            You can have many masters and run them all from the command line
                            or test suite by using the startup command-line parameter:
                                -master relative-path-to-master-file
                            or for maven, surefire, etc:
                                -Dmaster=relative-path-to-master-file
</pre>
    (see docs/RestReplay.html for examples).
</td>
<td><br></td></tr>
<tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-master.run" id="RestReplay-master.vars.var"></a>/restReplayMaster/vars/var</td>
          </tr>
          <tr>
<td><br></td>
<td>See also <a href="#1.c.4.Vars">1.c.4 Vars</a></td></tr>
<tr>
            <td>@id</td>

            <td>The name of the variable.  var elements declared here are available to all tests.  These are useful for
            defining host endpoints, or other values that will apply across all tests under a master.</td>
          </tr>
          <tr>
            <td><a name="protoHostPort_Example"></a>Master Example (with vars, uri, and protoHostPort):</td>

            <td>
<div class="code">    &lt;restReplayMaster&gt;
        &lt;protoHostPort&gt;<b>${SNOOPSERVER}</b>&lt;/protoHostPort&gt;
        &lt;vars&gt;
            &lt;var ID="<b>PISERVER</b>"&gt;http://piserver.example.com&lt;/var&gt;
            &lt;var ID="<b>LASSERVER</b>"&gt;http://localhost:8080&lt;/var&gt;
            &lt;var ID="<b>SNOOPSERVER</b>"&gt;http://localhost:28082&lt;/var&gt;
        &lt;/vars&gt;
        ...
    &lt;/restReplayMaster&gt;

    <b>Then, in a test file, you can use full URLs which reference these servers
    defined in the master control file:</b>

    &lt;restReplay&gt;
        &lt;protoHostPort&gt;<b>${LASSERVER}</b>&lt;/protoHostPort&gt;

        &lt;testGroup ID="mainTestGroup" autoDeletePOSTS="false"&gt;

            &lt;test ID="pitoken"&gt;
                &lt;method&gt;POST&lt;/method&gt;
                &lt;uri&gt;<b>${PISERVER}</b>/v1/piapi-int/tokens&lt;/uri&gt;
                &lt;filename&gt;pitoken.json&lt;/filename&gt;
            &lt;/test&gt;

            &lt;test ID="createAssignment"&gt;
                &lt;method&gt;POST&lt;/method&gt;
                &lt;uri&gt;<b>${SNOOPSERVER}</b>/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;

            &lt;test ID="getAssignments"&gt;
                &lt;method&gt;GET&lt;/method&gt;
                &lt;uri&gt;/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;
        &lt;/testGroup&gt;
    &lt;/restReplay&gt;

      <b>"uri" values that have a full url will go to that host. If they don't have http://host:port,
        then they will use "protoHostPort" element from the test file, then the
        master file.
        In this case:</b>
          createAssignment will go against SNOOPSERVER:  http://localhost:28082
          getAssignments will go against LASSERVER:      http://localhost:8080
          pitoken will go against PISERVER               http://piserver.example.com
   










<hr>    <b>But if protoHostPort were not defined in this test file, then the
    protoHostPort will be pulled in from the master file.</b>

        &lt;restReplayMaster&gt;
            &lt;protoHostPort&gt;<b>${SNOOPSERVER}</b>&lt;/protoHostPort&gt;
            &lt;vars&gt;
                &lt;var ID="<b>PISERVER</b>"&gt;http://piserver.example.com&lt;/var&gt;
                &lt;var ID="<b>LASSERVER</b>"&gt;http://localhost:8080&lt;/var&gt;
                &lt;var ID="<b>SNOOPSERVER</b>"&gt;http://localhost:28082&lt;/var&gt;
            &lt;/vars&gt;
            ...
            <run controlfile="_self_test/dynamide.xml" testgroup="secondTestGroup">
        &lt;/restReplayMaster&gt;

        &lt;restReplay&gt;
          &lt;testGroup ID="secondTestGroup" autoDeletePOSTS="false"&gt;
            &lt;test ID="getAssignments"&gt;
                &lt;method&gt;GET&lt;/method&gt;
                &lt;uri&gt;/las-api/api/grid-apex/assignments&lt;/uri&gt;
                &lt;filename&gt;create-assignment.json&lt;/filename&gt;
                ...
            &lt;/test&gt;
          &lt;/testGroup&gt;
       &lt;/restReplay&gt;

      <b>In this case, getAssignments will use the default from protoHostPort in
      the master file:</b>
      secondTestGroup.getAssignments will go against SNOOPSERVER               http://localhost:28082<br></run></div></td>
          </tr>






          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.envs" id="RestReplay-master.envs"></a>/restReplayMaster/envs</td>
          </tr>

          <tr>
              <td>&nbsp;</td>

              <td>Contains blocks of vars/var elements which define variables available to all tests run by this master.
                  <br>The calling program can supply the environment ID in the command-line parameter <b>-env</b>.
              <br>
              <br>
                  If calling restReplayInstance.readOptionsFromMasterConfigFile() programmatically, call restReplayInstance.setEnvID() first.
              </td>
          </tr>

          <tr>
              <td>child elements</td>

              <td><a href="#RestReplay-master.envs.vars">vars</a>
                  <br><a href="#RestReplay-master.envs.vars.var">vars/var</a></td>
          </tr>

          <tr>
              <td>@ID</td>

              <td>The environment ID, which is available for selection from the command line parameter -env, or the call RestReplay.setEnvID()</td>
          </tr>

          <tr>
              <td>default</td>

              <td>If true, this is the env which will be used if the user supplies none on the command line or programmatically.</td>
          </tr>


          <tr>
              <td>Example:</td>

              <td>
                  <div class="code">&lt;restReplayMaster&gt;
    &lt;protoHostPort&gt;${BESERVER}&lt;/protoHostPort&gt;
    &lt;envs&gt;
        &lt;env ID="local" default="true"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://localhost:8080&lt;/var&gt;
                &lt;var ID="SELFTEST_SERVER"&gt;http://localhost:18080&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
        &lt;env ID="dev"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://be.example.com&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
        &lt;env ID="qa"&gt;
            &lt;vars&gt;
                &lt;var ID="LISERVER"&gt;http://li-api.example.com&lt;/var&gt;
                &lt;var ID="BESERVER"&gt;http://be.example.com&lt;/var&gt;
            &lt;/vars&gt;
        &lt;/env&gt;
    &lt;/envs&gt;
    ...
    </div>

          </td></tr><tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.envs.vars" id="RestReplay-master.envs.vars"></a>/restReplayMaster/envs/vars</td>
          </tr>

          <tr>
              <td>child elements</td>

              <td>var</td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.envs.vars.var" id="RestReplay-master.envs.vars.var"></a>/restReplayMaster/envs/vars/var</td>
          </tr>

          <tr>
              <td><br></td>

              <td>A single variable, which will be available to all tests called by this master.
<br>                  Behaves exactly like <a href="#RestReplay-master.vars.var">/restReplayMaster/vars/var</a>&nbsp; except that the vars come from the <a href="#RestReplay-master.envs">environment</a> specified.<br>See examples at <a href="#RestReplay-master.envs">/restReplayMaster/envs</a><br>See also <a href="#1.c.4.Vars">1.c.4 Vars</a></td>
          </tr>

          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-master.run" id="RestReplay-master.run"></a>/restReplayMaster/run</td>
          </tr>

          <tr>
              <td>@controlFile</td>

              <td>name of <b>control</b> file, relative to RestReplay directory</td>
          </tr>

          <tr>
              <td>@testGroup</td>

              <td>ID of single testGroup within <b>control</b> file to run. To run multiple tests, use multiple /restReplayMaster/run elements.</td>
          </tr>

          <tr>
              <td>Example:</td>
<td>
                  <div class="code">&lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;</div>
              </td>
          </tr>
          <tr>
              <td>Example:</td>

              <td>
                  <div class="code">&lt;restReplayMaster&gt;
    ....
    &lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;
    &lt;run controlFile="objectexit/object-exit.xml" testGroup="CRUDL" /&gt;
                  </div>
              </td>
          </tr>

        </tbody>
      </table>












      <h4><a name="RestReplay-2.c.3XMLconfigurationparametersincontrolfile" id="RestReplay-2.c.3XMLconfigurationparametersincontrolfile"></a>2.c.3 XML configuration parameters in <b>control</b> file</h4>

      <p>Click on an element to jump to documentation for that element and its attributes.</p>
      <div id="TOCTEST" class="cheatsheet-body">
      <div class="cheatsheet-header">Test control file</div>
      <pre>  &lt;<a href="#RestReplay-restReplay">restReplay</a>&gt;
      &lt;<a href="#RestReplay-restReplay.auths">auths</a>&gt;
          &lt;<a href="#RestReplay-restReplay.auths.auth">auth</a>&gt;&lt;/auth&gt;
      &lt;/auths&gt;
      &lt;<a href="#RestReplay-restReplay.testGroup">testGroup</a>&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.comment">comment</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.protoHostPort">protoHostPort</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.vars.var">vars</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.headers.header">headers</a> /&gt;
          &lt;<a href="#RestReplay-restReplay.testGroup.test">test</a>&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.comment">comment</a> /&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.method">method</a> /&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.uri">uri</a> /&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.filename">filename</a> /&gt;<br>              &lt;<a href="#RestReplay-restReplay.testGroup.test.expected.code">expected</a>&gt;
                &lt;<a href="#RestReplay-restReplay.testGroup.test.expected.code">code</a> /&gt;
              &lt;/expected&gt;<br>             &nbsp;&lt;<a title="mutator" href="#RestReplay-restReplay.testGroup.test.mutator">mutator</a>&gt;
                  &lt;expected&gt;
                    &lt;<a href="#RestReplay-restReplay.testGroup.test.mutator">code</a> /&gt;
                  &lt;/expected&gt;
              &lt;/mutator&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.vars.var">vars</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.vars.var">var /</a>&gt;
              &lt;/vars&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.exports">exports</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.exports.vars.var">vars</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.exports.vars.var">var /</a>&gt;
                  &lt;/vars&gt;
              &lt;/exports&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.headers.header">headers</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.headers.header">header /</a>&gt;
              &lt;/headers&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.parts">parts</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.part">part</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.label">label /</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.filename">filename /</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.parts.part.var">var /</a>&gt;
                  &lt;/part&gt;
              &lt;/parts&gt;
              &lt;<a href="#RestReplay-restReplay.testGroup.test.response">response</a>&gt;
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.expected">expected</a>/&gt;  
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.validator">validator</a>/&gt;  
                  &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts">parts</a>&gt;
                      &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part">part</a>&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.label">label</a> /&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.f...">filename</a> /&gt;
                          &lt;<a href="#RestReplay-restReplay.testGroup.test.response.parts.part.var">var</a> /&gt;
                      &lt;/part&gt;
                  &lt;/parts&gt;
              &lt;/response&gt;
          &lt;/test&gt;
      &lt;/testGroup&gt;
  &lt;/restReplay&gt;</pre>
     </div>
      <table border="1" cellpadding="3" cellspacing="0">
        <tbody>
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay" id="RestReplay-restReplay"></a>/restReplay</td>
          </tr>

          <tr>
            <td>restReplay</td>

            <td>Root element of a RestReplay <b>control</b> file.</td>
          </tr>

          <tr>
            <td>child nodes</td>

            <td>protoHostPort<br>
                          auths<br>
                          testGroup</td>
          </tr>








          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.auths" id="RestReplay-restReplay.auths"></a>/restReplay/auths</td>
          </tr>

          <tr>
            <td>auths</td>

            <td>This element adds to any auths placed in the <b>master</b> file. Any ID defined in the <b>control</b> file overrides an auth of the same ID defined in the <b>master</b> file.</td>
          </tr>

          <tr>
            <td>child elements</td>

            <td>auth</td>
          </tr>

          <tr>
            <td>@default</td>

            <td>the user ID to use if none is specified in the test</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.auths.auth" id="RestReplay-restReplay.auths.auth"></a>/restReplay/auths/auth</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>a cspace user ID</td>
          </tr>

          <tr>
            <td>element text</td>

            <td>Base-64 encrypted username:password</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>Example:</p>

              <div class="code">
&lt;auths default="admin@example.org"&gt;
&lt;auth ID="admin@example.org"&gt;YWRtaW5AY29sbGVjdGlvbnNwYWNlLm9yZzpBZG1pbmlzdHJhdG9y&lt;/auth&gt;
&lt;/auths&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup" id="RestReplay-restReplay.testGroup"></a>/restReplay/testGroup</td>
          </tr>

          <tr>
            <td>testGroup</td>
            <td>Runs a group of tests</td>
          </tr>

          <tr>
            <td>child elements</td>
            <td>comment<br />
                headers<br>
                          vars<br>
                          test
          </td></tr>

          <tr>
            <td>@ID</td>

            <td>A unique, valid ID for this testGroup.<br>
            The <b>master</b> file uses this ID in its /restReplayMaster/run element to specify this testGroup to run.</td>
          </tr>

          <tr>
            <td>@autoDeletePOSTS</td>

            <td>"true" - resource will be autoDeleted.<br>
            "false" - resources will not be autoDeleted</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>Example:</p>

              <div class="code">
&lt;testGroup ID="CRUDL" autoDeletePOSTS="true"&gt;
  &lt;test ID="foo"&gt;....&lt;/test&gt;
&lt;/testGroup&gt;
              </div>
            </td>
          </tr>


          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.comment" id="RestReplay-restReplay.testGroup.comment"></a>
                  /restReplay/testGroup/comment</td>
          </tr>
          <tr>
              <td>comment</td>
              <td><p>Any text you want to include in the report to describe this testGroup.  Appears just under the testGroup banner
              in the master report index and in the detail pages.  You may include any HTML markup.</p></td>
          </tr>


         


          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.vars.var" id="RestReplay-restReplay.testGroup.vars.var"></a>/restReplay/testGroup/vars/var</td>
          </tr>
          <tr>
            <td>var</td>
            <td>A variable that will be expanded just before the test is run.  Available to use in uri element.<br>The body of the element is a&nbsp; <a href="http://commons.apache.org/proper/commons-jexl/reference/syntax.html">Jexl2 Expression</a>, discussed in this document under <a href="#1.c.1.Expressions">1.c.1 Expressions</a> and <a href="#1.c.2.ValuesInContexts">1.c.2 Values in Contexts</a>.<br><br>See also: <a href="#1.c.4.Vars">1.c.4 Vars</a><br><br>For more programmatic horsepower (such as javascript/rhino, and XPath expressions) see the discussion on response validators:<br>&nbsp; &nbsp;&nbsp; <a href="#RestReplay-restReplay.testGroup.test.response.validator">/restReplay/testGroup/test/response/validator</a>.</td>
          </tr>
          <tr>
<td>@ID</td>
<td>The ID attribute of var makes that variable available in the test's namespace under that ID.&nbsp; So requests can use ${COURSE_ID} to get the value 540f4515e4b004e7d8f22fc8 because COURSE_ID was the ID attribute value, in this next example. In other words, the value of the ID becomes a variable in the target language.&nbsp; </td></tr>
<tr>
            <td>Example:</td>
            <td>
              <div class="code">
    &lt;restReplay&gt;
      &lt;protoHostPort&gt;...&lt;/protoHostPort&gt;
      &lt;testGroup ID="mainTestGroup"&gt;
        &lt;vars&gt;
            &lt;var ID="<b>COURSE_ID</b>"&gt;540f4515e4b004e7d8f22fc8&lt;/var&gt;
            &lt;var ID="TEMPLATE_ID"&gt;87fff5f0-652d-11e4-8229-179090669834&lt;/var&gt;
        &lt;/vars&gt;
        ...
        &lt;test ID="getAssignments"&gt;
            &lt;method&gt;GET&lt;/method&gt;
            &lt;uri&gt;/las-api/api/grid-apex/courses/<b>${COURSE_ID}</b>/assignments&lt;/uri&gt;
              </div>
            </td>
          </tr>
          
          
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.headers.header" id="RestReplay-restReplay.testGroup.headers.header"></a>/restReplay/testGroup/headers/header</td>
          </tr>
          <tr>
            <td>header</td>
            <td>A header that will be expanded just before the test is run.  If you need to force a particular test to skip including all the headers set by the testGroup,
            set inheritHeaders="false" on that &lt;test&gt; node.</td>
          </tr>
          <tr>
            <td>Example:</td>
            <td>
              <div class="code">
    &lt;restreplay&gt;
      &lt;testGroup ID="mainTestGroup"&gt;
        &lt;headers&gt;
            &lt;header name="X-ApiKey"&gt;19d26d452432968c9b636c9daf0c6d9b&lt;/header&gt;
            &lt;header name="x-authorization"&gt;${pitoken.got("//data")}&lt;/header&gt;
        &lt;/headers&gt;
        &lt;vars&gt;
            &lt;var ID="COURSE_ID"&gt;540f4515e4b004e7d8f22fc8&lt;/var&gt;
            &lt;var ID="TEMPLATE_ID"&gt;87fff5f0-652d-11e4-8229-179090669834&lt;/var&gt;
        &lt;/vars&gt;

        &lt;test ID="pitoken" <span class="note1">inheritHeaders="false"</span>&gt;
            <b>&lt;-- Will NOT inherit headers --&gt;</b>
            &lt;method&gt;POST&lt;/method&gt;
            &lt;uri&gt;${PISERVER}/v1/piapi-int/tokens&lt;/uri&gt;
            &lt;filename&gt;pitoken.json&lt;/filename&gt;
        &lt;/test&gt;
        
        &lt;test ID="deleteTemplate"&gt;
            <b>&lt;-- Will inherit headers: X-ApiKey and x-authorization --&gt;</b>
            &lt;method&gt;DELETE&lt;/method&gt;
            &lt;uri&gt;/las-api/api/grid-apex/courses/${COURSE_ID}/templates/${TEMPLATE_ID}&lt;/uri&gt;
        &lt;/test&gt;
    &lt;/restreplay&gt;
             </div>
            </td>
          </tr>


          <tr>
              <td>Example:</td>
              <td>
                  <div class="code">
    &lt;restreplay&gt;
      &lt;testGroup ID="mainTestGroup"&gt;
          &lt;headers&gt;
             &lt;header name="X-ApiKey"&gt;19d26d452432968c9b636c9daf0c6d9b&lt;/header&gt;
             &lt;header name="x-authorization"&gt;${pitoken.got("//data")}&lt;/header&gt;
          &lt;/headers&gt;
          &lt;vars&gt;
              &lt;var ID="COURSE_ID"&gt;540f4515e4b004e7d8f22fc8&lt;/var&gt;
              &lt;var ID="TEMPLATE_ID"&gt;87fff5f0-652d-11e4-8229-179090669834&lt;/var&gt;
          &lt;/vars&gt;

          &lt;test ID="pitoken" <span class="note1">inheritHeaders="false"</span>&gt;
              &lt;method&gt;POST&lt;/method&gt;
              &lt;uri&gt;${PISERVER}/v1/piapi-int/tokens&lt;/uri&gt;
              &lt;filename&gt;pitoken.json&lt;/filename&gt;
              <b>&lt;-- Will NOT inherit headers --&gt;</b>
              <b>&lt;-- And can still define its own headers --&gt;</b>
              &lt;headers&gt;
                  &lt;header name="X-SomeParameter"&gt;19d26d452432968c9b636c9daf0c6d9b&lt;/header&gt;
              &lt;/headers&gt;
          &lt;/test&gt;
  &lt;/restreplay&gt;</div>
              </td>
          </tr>








          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test" id="RestReplay-restReplay.testGroup.test"></a>/restReplay/testGroup/test</td>
          </tr>

          <tr>
            <td>test</td>

            <td>A test exists in a testGroup, and defines one request/response/validation set.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>This ID must be unique within this file. Will become a variable name in the expression context bound to the ServiceResult object for this request/response.</td>
          </tr>

          <tr>
            <td>@auth</td>

            <td>the ID of the /restReplay/auths/auth or /restReplayMaster/auths/auth element to use for this request.<br>
            IMPORTANT: These are sticky - they stick around until reset by the next @auth specified in a test, in exec order of the tests in this file.</td>
          </tr>
          
          <tr>
            <td>@inheritHeaders</td>

            <td><code>boolean: true|false</code>  Default=true. If false, headers set in the master or testGroup will not be used by this test: only headers set
            within this test are sent to the server.</td>
          </tr>

          <tr>
              <td>@loop</td>

              <td><i>OPTIONAL. </i> integer.  Default=1. Sets the number of loops to run. Repeats the service call <em><strong>loop</strong></em> times.  Within validators, scripts, and expressions, the value of the current loop
                  index (zero-based) is <b>this.LoopIndex</b>
                  <br>

                  Use 0 (zero) to exclude this test. The test will not run or show up in reports.
                  (NOTE: Normally, you'll want to exclude tests by putting them in another testGroup.)

                  <br>
                  <br>Example:  (loop 3 times, from loopyTest_0 to loopyTest_2 )
                  <div class="code">    &lt;test ID="loopyTest" loop="3"&gt;...                  </div>
                  </td>
          </tr>


          <tr>
            <td>child elements</td>

            <td>comment<br>
                method<br>
                uri<br>expected<br>
                part<br>
                parts</td>
            </tr>

          <tr>
            <td>Example</td>

            <td>
              <div class="code">
&lt;test ID="oePersonauthority"&gt;
     &lt;method&gt;POST&lt;/method&gt;
     &lt;uri&gt;/cspace-services/personauthorities/&lt;/uri&gt;
     &lt;part&gt;
         &lt;label&gt;personauthorities_common&lt;/label&gt;
         &lt;filename&gt;objectexit/oePersonauthority.xml&lt;/filename&gt;
     &lt;/part&gt;
&lt;/test&gt;
              </div>
            </td>
          </tr>

          <tr>
            <td>Example</td>

            <td>
              This example shows switching auths between tests, and how the auths are sticky -- they stick around until another is set, or reset with auth="".<br>
              <br>"permBigbird" and "accountBigbird" tests are run as user <em>admin@example.org</em>.<br><br>"dimension1" and "dimension1" tests are run as user <em>bigbird2010</em>.<br><br>This would test the flow of allowing an admin account to change a regular user's permissions and accounts, then testing that that regular user can access other services.<br><div class="code">
&lt;test ID="permBigbird" auth="admin@example.org"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/authorization/permissions&lt;/uri&gt;
    &lt;filename&gt;security/1-bigbird-permission.xml&lt;/filename&gt;
&lt;/test&gt;<br><br>&lt;test ID="accountBigbird"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/accounts&lt;/uri&gt;
    &lt;filename&gt;security/5-account-bigbird.xml&lt;/filename&gt;
&lt;/test&gt;<br><br>&lt;test ID="dimension1"  auth="bigbird2010"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/cspace-services/dimensions/&lt;/uri&gt;
    &lt;part&gt;
        &lt;label&gt;dimensions_common&lt;/label&gt;
        &lt;filename&gt;dimension/1.xml&lt;/filename&gt;
    &lt;/part&gt;
&lt;/test&gt;
<br>&lt;test ID="dimension2"&gt;
    &lt;method&gt;PUT&lt;/method&gt;
    &lt;uri&gt;/cspace-services/dimensions/${dimension1.CSID}&lt;/uri&gt;
    &lt;part&gt;
        &lt;label&gt;dimensions_common&lt;/label&gt;
        &lt;filename&gt;dimension/2-put.xml&lt;/filename&gt;
    &lt;/part&gt;
&lt;/test&gt;              </div>
            </td>
          </tr>


          <tr>
              <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.comment" id="RestReplay-restReplay.testGroup.test.comment"></a>
                  /restReplay/testGroup/test/comment</td>
          </tr>
          <tr>
              <td>comment</td>
              <td><p>Any text you want to include in the report for this test, on the same line as the testID.  If the text is long, comment appears with a "more..." link. You may include any HTML markup.
              </p>
              </td>
          </tr>


          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.vars.var" id="RestReplay-restReplay.testGroup.test.vars.var"></a>
             /restReplay/testGroup/test/vars/var</td>
          </tr>
          <tr>
            <td>var</td>
            <td>The same as <a href="#RestReplay-restReplay.testGroup.vars.var">/restReplay/testGroup/vars/var</a>, but limited to one test.&nbsp; See also <a href="#1.c.4.Vars">1.c.4 Vars</a></td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.expected.code" id="RestReplay-restReplay.testGroup.test.expected.code"></a>
              /restReplay/testGroup/test/expected/code</td>
            <td><br></td></tr>
            <tr>
            <td>code</td>

            <td>&lt;expected&gt; contains zero to many <strong>&lt;code range="" /&gt; </strong>elements.&nbsp;
                The child or text of this element may be empty when this is a child of <strong>test</strong>,
                and not a child of <strong>mutator</strong>.&nbsp;&nbsp;
                When the tag is found under <a href="#RestReplay-restReplay.testGroup.test.mutator">&lt;mutator&gt;&lt;expected&gt;&lt;code&gt;</a> ,
                then additional rules apply--please see that section.<br><br>The &lt;<strong>code</strong>&gt; element defines acceptable HTTP response codes for groups of mutations.&nbsp;


  If you don't specify test/expected/code/ then the default is as though you specified
  <br><b>&lt;expected&gt;&lt;code range="2x"/&gt;&lt;/expected&gt;</b>
    <br><br>
  <div class="code">&lt;test ID="specificCodes"&gt;
    &lt;method&gt;GET&lt;/method&gt;<br>   &nbsp;&lt;uri&gt;/tagonomy?mock=true&lt;/uri&gt;
    &lt;expected&gt;  <br>            &lt;code range="200" /&gt;
            &lt;code range="202,204-206" /&gt;
    &lt;/expected&gt;    <br>&lt;/test&gt;  </div>
              
              These range attributes work like printer page ranges.&nbsp;&nbsp; It is a string that contains a comma separated list of ranges, where a range is a low and a high, inclusive.&nbsp; A single number without a hyphen is a range with the high and the low being the same.&nbsp; A list may be a single number or series wildcard, in which case there are no commas.<br><br><em>Basic syntax examples for the range attribute: </em><br><strong>200</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The range will be from 200 to 200, exluding all other 2x values such as 201.<br><strong>2x</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The range will be from 200-299.<br><strong>200-209</strong>&nbsp;&nbsp;&nbsp;&nbsp; from-to, inclusive.&nbsp; Internally these map to <em>ranges (org.dynamide.restreplay.Range)</em>.<br><strong>200,201,204</strong> &nbsp;&nbsp; comma separated list. response codes 200, 201, and 204 are acceptable, but 202, 203 are not, nor any other codes.&nbsp; Call these <em>lists</em>.<br><strong>2x,301-302</strong> &nbsp;&nbsp; commas and&nbsp; <em>ranges</em> (pairs separated by hyphens) may be combined. &nbsp; <br>&nbsp;<strong>x </strong><em>or</em><strong> xx </strong><em>or</em><strong> X </strong><em>or</em><strong> XX</strong>&nbsp;&nbsp;&nbsp; are all wildcards for the http response code groups,
              so 2X and 2xx both expand to 200-299.  range="200" only succeeds if server sends exactly 200, but range="2x" succeeds if server sends 
              a 200, a 201, a 202, and so on. <br><br>Here are other range examples: 
                  
              















































<div class="code"> &lt;code range="100" /&gt;
 &lt;code range="1xx" /&gt;
 &lt;code range="2xx" /&gt;
 &lt;code range="2x" /&gt;
 &lt;code range="2XX" /&gt;
 &lt;code range="2X" /&gt;
 &lt;code range="3xx" /&gt;
 &lt;code range="2xx" /&gt;
 &lt;code range="4xx" /&gt;
 &lt;code range="5xx" /&gt;
 &lt;code range="100,200,300" /&gt;
 &lt;code range="100-400" /&gt;
 &lt;code range="202,204-206" /&gt;
 &lt;code range="100-201,300-399,404-499" /&gt;</div>
              </td>
          </tr>
          
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.headers.header" id="RestReplay-restReplay.testGroup.test.headers.header"></a>
              /restReplay/testGroup/test/headers/header</td>
          </tr>
          <tr>
            <td>header</td>
            <td>The same as <a href="#RestReplay-restReplay.testGroup.headers.header">restReplay/testGroup/headers/header</a>, but limited to one test</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.exports" id="RestReplay-restReplay.testGroup.test.exports"></a>
               /restReplay/testGroup/test/exports</td>
          </tr>
          <tr>
            <td>exports</td>
            <td><b>After</b> the test is run, export a variable which can be referenced by another test, and can use values from the response.  
            You could define this in another, dependent test
            using syntax like ${firstTest.someExpression} but using exports puts that definition closer to the test, and so makes the dependent test cleaner.</td>
          </tr>
          <tr>
            <td>child elements</td>
            <td>vars<br>vars/var  - The same as <a href="#RestReplay-restReplay.testGroup.vars.var">restReplay/testGroup/vars/var</a></td>
          </tr>
          
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.exports.vars.var" id="RestReplay-restReplay.testGroup.test.exports.vars.var"></a>
             /restReplay/testGroup/test/exports/vars/var</td>
          </tr>
          <tr>
            <td>var</td>
            <td>Evaluated <b>after</b> the test is run; otherwise similar to 
            <a href="#RestReplay-restReplay.testGroup.vars.var">restReplay/testGroup/vars/var</a> (and limited to one test). See also <a href="#1.c.4.Vars">1.c.4 Vars</a></td>
          </tr>
          
          


          
          
          
          
          
          

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.method" id="RestReplay-restReplay.testGroup.test.method"></a>/restReplay/testGroup/test/method</td>
          </tr>

          <tr>
            <td>method</td>

            <td>GET<br>
            POST<br>
            PUT<br>
            DELETE</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.uri" id="RestReplay-restReplay.testGroup.test.uri"></a>/restReplay/testGroup/test/uri</td>
          </tr>

          <tr>
            <td>uri</td>

            <td>The portion of the URL after protocol, host, and port.</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              Examples:<br>
              If URL is&nbsp; <a href="http://localhost:8180/cspace-services/personauthorities/" class="external-link" rel="nofollow">http://localhost:8180/cspace-services/personauthorities/</a><br>
              then uri is /cspace-services/personauthorities/<br>
              The uri contains any required queryString parameters:

              












































































<div class="code">
    &lt;uri&gt;/cspace-services/objectexit/?sortBy=&amp;pgNum=2&amp;pgSz=1&lt;/uri&gt;
                </div>
              

              <p>The uri element may contain expression variables:</p>

              <div class="code">
    &lt;uri&gt;/cspace-services/personauthorities/${oePersonauthority.CSID}&lt;/uri&gt;
              </div>

              <p>This example uses the CSID returned in the Location header the server sent back when executing &lt;test ID="oePersonauthority"&gt;</p>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.filename" id="RestReplay-restReplay.testGroup.test.filename"></a>/restReplay/testGroup/test/filename</td>
          </tr>
          
<tr>
<td><br></td>
<td>If the request is not multipart, you can simply place the &lt;filename&gt; element under the &lt;test&gt; element.&nbsp; If the request is mime-multipart, this element goes in a &lt;part&gt; element. Like all filenames in RestReplay, the value is relative to the <strong>-testdir</strong> directory.</td>
<td><br></td></tr>
<tr>
<td>Example: </td>
<td>&lt;filename&gt;_self_test/content-mutator-test.json&lt;/filename&gt;</td>
<td><br></td>
</tr>
          
<tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.uri" id="RestReplay-restReplay.testGroup.test.mutator"></a>/restReplay/testGroup/test/mutator</td>
          </tr>

          <tr>
              <td>@skipParent</td>
              <td>If true, then the mutator will skip running the test before it runs the mutations.  The parent test will show
                  up in the report, with a response code of 0, the label skipped=true, and will be missing headers and responses.
                  If false or absent, the mutator will run the test (as the parent) then run the mutations (as children).
                  In the report, you can recognize mutations because they are indented, and have the label type: which shows the mutator type.

              </td>
              <td><br></td>
          </tr>

<tr>
<td>Discussion</td>
<td>The &lt;<strong>mutator</strong>&gt; element loads a Mutator, defined by the <strong>type</strong> attribute.&nbsp;
  Currently, defined mutators are: "ExcludeFields" and "VarMutator".<br>
  <br>Mutators look at the JSON for a POST or PUT, and mutates the payload somehow.  They make the mutation ID and Index available.
  <br>
    It then executes a request to the server with this mutation and reports results underneath the test, one for each variant.&nbsp;
  <br><br>The &lt;<strong>code</strong>&gt; element defines acceptable HTTP response codes for groups of mutations.&nbsp;
  Each mutation is named using a strategy of the mutator implementation, and may reflect the index, or a key field.
    &nbsp; In the example below, mutation
  <span style="font-weight: bold;">numOfDrafts</span> expects the server to succeed in the range 200-299.&nbsp;
  The mutations <strong>book_id</strong> and&nbsp; <strong>course_id</strong> are expected to be rejected by the server with
  response code in the 400-499 and 500-599 ranges.&nbsp;
  The default (<strong>*</strong>) is to expect the server to respond to all other named mutations with code 200 in the statement
  <b>&lt;code range="200"&gt;*&lt;/code&gt;</b>
    <br>
    <em><br>See also </em><a href="#RestReplay-restReplay.testGroup.test.expected.code">&lt;test&gt;&lt;expected&gt;&lt;code&gt;</a> documentation for how <strong>code</strong> ranges work outside of mutators.<br><em>See also</em> <a href="#RestReplay-restReplay.testGroup.test.response.expected">&lt;test&gt;&lt;response&gt;&lt;expected level=""&gt;</a> documentation for how the <strong>expected</strong> tag implements tree matching.<br>
    <em>See also</em>: <a href="#RestReplay-restReplay.testGroup.test">Looping tests with test@loop</a>

</td>
<td><br></td></tr>
<tr>
  <td>ExcludeFields - Discussion</td>
  <td>This mutator (type="ExcludeFields") looks at the JSON for a POST or PUT, and one-by-one removes the top-level fields.&nbsp;
      It then executes a request to the server with this mutation and reports results underneath the test, one for each variant.&nbsp;
      <br><br>The &lt;<strong>code</strong>&gt; element defines acceptable HTTP response codes for groups of mutations.&nbsp;
      Since this mutator looks at top-level fields, each mutation is named after the missing field.&nbsp;Note that when <strong>expected/code</strong> nodes are used under <strong>mutator</strong> elements, then <strong>code</strong> must contain mutation ids, or the wildcard (*).&nbsp; If you omit the id or the wildcard, that code range will default as though you <em>had</em> used * and will conflict with any other wildcard code ranges.</td>
  <td><br></td></tr>
<tr>
<td><a name="test.mutator.expected.code"></a>ExcludeFields Example:</td>
<td>
  <div class="code">&lt;test ID="dynamideUseMutator"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/tagonomy?mock=true&lt;/uri&gt;
    &lt;filename&gt;_self_test/content-mutator-test.json&lt;/filename&gt;
    &lt;mutator type="ExcludeFields"&gt;
        &lt;expected&gt;
            &lt;code range="200"&gt;*&lt;/code&gt;
            &lt;code range="200-299"&gt;numOfDrafts&lt;/code&gt;
            &lt;code range="400-499,500-599"&gt;book_id, course_id&lt;/code&gt;
        &lt;/expected&gt;
    &lt;/mutator&gt;
&lt;/test&gt;
  </div>
  
  Example showing default wildcard.  Mutations that are not book_id, and course_id are expected to get a 200 response code:
  













































<div class="code">&lt;test ID="dynamideUseMutator"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/tagonomy?mock=true&lt;/uri&gt;
    &lt;filename&gt;_self_test/content-mutator-test.json&lt;/filename&gt;
    &lt;mutator type="ExcludeFields"&gt;
        &lt;expected&gt;
            &lt;code range="200" /&gt;
            &lt;code range="400-499,500-599"&gt;book_id, course_id&lt;/code&gt;
        &lt;/expected&gt;
    &lt;/mutator&gt;
&lt;/test&gt;
  </div>
  
  This example will cause an error, because you have specified the default twice (once with * and once with an empty text node) :
  













































<div class="code">&lt;test ID="dynamideUseMutator"&gt;
    &lt;method&gt;POST&lt;/method&gt;
    &lt;uri&gt;/tagonomy?mock=true&lt;/uri&gt;
    &lt;filename&gt;_self_test/content-mutator-test.json&lt;/filename&gt;
    &lt;mutator type="ExcludeFields"&gt;
        &lt;expected&gt;
            &lt;code range="200"&gt;*&lt;/code&gt;
            &lt;code range="202"&gt;<span style="color: #cc0000;"><span style="color: black;">&lt;/code&gt;</span>      &lt;!-- error: this will be a duplicate for * --&gt;</span>
            &lt;code range="202" /&gt;<span style="color: #cc0000;">           &lt;!-- same error with stand-alone tag --&gt;</span>
            &lt;code range="400-499,500-599"&gt;book_id, course_id&lt;/code&gt;
        &lt;/expected&gt;
    &lt;/mutator&gt;
&lt;/test&gt;
  </div>
  </td>
  
  
  <td><br></td></tr>

          <tr>
              <td>VarMutator Example:</td>
              <td>
                  <p>VarMutator re-applies the service call, once for each of these vars blocks, which set vars before the call, in the file-order of the vars groups.
                  IDs are informational strings--set to any alphanumeric string.  Here is an example from the RestReplay self-test.
                  </p>

                  <p>Note that inside the test, you can use this.mutator.getMutationID() which will return the ID attribute
                      for this var, and this.mutator.getIndex() to get the loop index. </p>
                  
















<div class="code">
&lt;test ID="selftestUseVarMutator"&gt;
    &lt;method&gt;PUT&lt;/method&gt;
    &lt;uri&gt;/tagonomy?mock=true&amp;mutation=${this.mutation}&amp;forceCode=300&lt;/uri&gt;
    &lt;filename&gt;_self_test/var-mutator-test.json&lt;/filename&gt;
    &lt;vars&gt;
        &lt;var ID="DAYS"&gt;${24*60*60*1000}&lt;/var&gt;
        &lt;var ID="BASE_DATE"&gt;${tools.now()}&lt;/var&gt;
        &lt;var ID="DUE_DATE_MILLIS"&gt;${BASE_DATE +0 * DAYS}&lt;/var&gt;
        &lt;var ID="FOOBAR"&gt;${this.testID}&lt;/var&gt;
        &lt;var ID="DueDate2"&gt;Due ${BASE_DATE} -basedate&lt;/var&gt;
        &lt;var ID="DueDate"&gt;Due ${kit.dates.getMonthName(BASE_DATE)} ${kit.dates.getDayOfMonth(BASE_DATE)}&lt;/var&gt;
    &lt;/vars&gt;
    &lt;mutator type="VarMutator"&gt;
        &lt;expected&gt;
            &lt;code range="4xx"&gt;*&lt;/code&gt;
        &lt;/expected&gt;
        &lt;vars ID="0"&gt;
            &lt;var idbase="DUE_DATE_MILLIS"&gt;${BASE_DATE +1 * DAYS}&lt;/var&gt;
            &lt;var idbase="FOOBAR"&gt;${this.testID} set in 0.&lt;/var&gt;
        &lt;/vars&gt;
        &lt;vars ID="1"&gt;
            &lt;var idbase="DUE_DATE_MILLIS"&gt;${BASE_DATE +2 * DAYS}&lt;/var&gt;
            &lt;var idbase="FOOBAR"&gt;${this.testID + ' mutator index: ' + this.mutator.getIndex() }&lt;/var&gt;
        &lt;/vars&gt;
        &lt;vars ID="2"&gt;
            &lt;var idbase="DUE_DATE_MILLIS"&gt;${BASE_DATE +3 * DAYS}&lt;/var&gt;
            &lt;var idbase="FOOBAR"&gt;${this.testID + ' mutator index: ' + this.mutator.getIndex() }&lt;/var&gt;
        &lt;/vars&gt;
        &lt;vars ID="3"&gt;
            &lt;var idbase="FOOBAR"&gt;${this.testID + ' mutator index: ' + this.mutator.getIndex() }&lt;/var&gt;
        &lt;/vars&gt;
    &lt;/mutator&gt;
&lt;/test&gt;

                  </div>
              </td>


              <td><br></td></tr>
<tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts" id="RestReplay-restReplay.testGroup.test.parts"></a>/restReplay/testGroup/test/parts</td>
          </tr>

          <tr>
            <td>parts</td>

            <td>Optional container for "part" elements. Needed if there are more than one part element, otherwise not needed.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part" id="RestReplay-restReplay.testGroup.test.parts.part"></a><a name="RestReplay-restReplay.testGroup.test.part" id="RestReplay-restReplay.testGroup.test.part"></a>/restReplay/testGroup/test/part<br>
            /restReplay/testGroup/test/parts/part</td>
          </tr>

          <tr>
            <td>part</td>

            <td>If there is just one part, the parts container element may be omitted.<br>
            A schema part sent to server in request, identified by a schema name in the "label" child element.<br>
            Models a request schema part sent in either a multipart mime message,<br>
            or in a CSpace 1.4 style application/xml message delimited by xml elements describing the schema part.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.label" id="RestReplay-restReplay.testGroup.test.parts.part.label"></a>/restReplay/testGroup/test/parts/part/label</td>
          </tr>

          <tr>
            <td>label</td>

            <td>A schema name for this part, such as "objectexit_common", or "collectionspace_core".</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.filename" id="RestReplay-restReplay.testGroup.test.parts.part.filename"></a>/restReplay/testGroup/test/parts/part/filename</td>
          </tr>

          <tr>
            <td>filename</td>

            <td>The filename of the payload, relative to the RestReplay directory (not relative to the <b>control</b> file).</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>&amp;&lt;filename&gt;objectexit/object-exit.xml&lt;/filename&gt;</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.parts.part.var" id="RestReplay-restReplay.testGroup.test.parts.part.var"></a>/restReplay/testGroup/test/parts/part/var</td>
          </tr>

          <tr>
            <td>var</td>

            <td>Declares a variable to be made available to the expansion of the part template.<br>See also<a href="#RestReplay-restReplay.testGroup.vars.var"> /restReplay/testGroup/vars/var</a> for a discussion of the expression languaged used inside a var.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>the name of the variable that can be dereferenced in an expression e.g. &lt;var ID="depositor"&gt;...&lt;/var&gt;</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              var may be dereferenced in an expression in the request payload.like this:


<div class="code">
    &lt;depositor&gt;${depositor}&lt;/depositor&gt;
              </div>

              <p>The var itself may include any expression syntax in its element text, so that vars can be set based on any previous tests or java objects in the expression namespace.<br>
              e.g.</p>

              <div class="code">
    &lt;var ID="depositor"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
              </div><br>
              In context, this looks like:
<div class="code">
    &lt;test ID="oeObject"&gt;
        &lt;method&gt;POST&lt;/method&gt;
        &lt;uri&gt;/cspace-services/objectexit/&lt;/uri&gt;
        &lt;part&gt;
            &lt;label&gt;objectexit_common&lt;/label&gt;
            &lt;filename&gt;objectexit/oeObject.xml&lt;/filename&gt;
            &lt;var ID="depositor"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
            &lt;var ID="currentOwner"&gt;${oePersonGET.got("persons_common","//refName")}&lt;/var&gt;
            &lt;var ID="exitNumber"&gt;oeObject-exitnum-123&lt;/var&gt;
        &lt;/part&gt;
    &lt;/test&gt;
              </div>

              <p>In this example, the ServiceResult object from the previous test identified by &lt;test ID="oePersonGET"&gt; exposes a method called got(String partLabel, String elementXPath), which can extract the node text for an element in a schema
              part returned by a response.</p>
            </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response" id="RestReplay-restReplay.testGroup.test.response"></a>/restReplay/testGroup/test/response</td>
          </tr>
          <tr>
            <td>response</td>
            <td>Container for evaluating the response from the server</td>
          </tr>

          <tr>
            <td>child elements</td>
            <td>expected<br>
            parts<br>
            part<br>
            validator</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.validator" id="RestReplay-restReplay.testGroup.test.response.validator"></a>/restReplay/testGroup/test/response/validator</td>
          </tr>
          <tr>
            <td>validator</td>
            <td>Contains a filename reference to a validator script.  Like all filenames in the control file it is relative to the tests directory.
            <br>The script validates the response from the server.  Available to the validator 
                are the request, response, and everything in the ServiceResult class, and the map of all previously run tests in this test group
                (in the file order of the control file).</td>
          </tr>


          <tr>
              <td>variables in context</td>
            <td>
                

              The standard <a href="#1c.1.ValuesInContexts">Values in Contexts</a> apply, depending on whether you are using Javascript or Jexl.&nbsp; Additionally, the value __FILE__ is the full path to the validator.</td>
          </tr>

          <tr>
              <td>Exports are tracked</td>

              <td>
                  <p>Exports added with this.addExport() get tracked automatically, and the list of exports added per validator is shown in the detail report as an Alert 
                from the validator.  The values of these exports can then be seen in the variables row (exports are a different background color--see Legend at bottom of page).</p></td>
          </tr>

          <tr>
            <td>@lang</td>
            <td>Supported values are <b>javascript</b> and <b>jexl</b>.  Default is <b>jexl</b>.  This is the language used for the validator.  
            Jexl scripts must be surrounded by ${}, 
            and you may have multiple blocks like that, wrapped in text, e.g. Foo${result.testID} Bar Baz ${result.gotExpectedResult()}.<br>
            JavaScript blocks should have a return statement as the last line, or an expression as the last line, which will be the result.
          </td></tr>
          
          <tr>
            <td>example<br>&nbsp;(control file)</td>
            <td>
<div class="code">&lt;test ID="testA"&gt;
    &lt;uri&gt;
        ...
    &lt;response&gt;
        &lt;validator lang="jexl"&gt;<b>assignments/res/testA.validator.jexl</b>&lt;/validator&gt;
    &lt;/response&gt;
&lt;/test&gt;

&lt;test ID="testB"&gt;
    &lt;uri&gt;
        ...
    &lt;response&gt;
        &lt;filename&gt;assignments/res/testB.json&lt;/filename&gt;
        &lt;validator lang="javascript"&gt;<b>assignments/res/testB.validator.js</b>&lt;/validator&gt;
    &lt;/response&gt;
&lt;/test&gt;</div>
Note: in this example, the &lt;filename&gt; element points to a file containing the
expected response.  RestReplay automatically compares the response to this
expected response file for content, based on the element
<a href="#RestReplay-restReplay.testGroup.test.response.expected">/restReplay/testGroup/test/response/expected</a>.  The validator is then run as a
separate validation step. 
          </td></tr>
          
          <tr>
            <td>example<br>&nbsp;(script file)<br>&nbsp;@lang="jexl"</td>
            <td><b>assignments/res/testA.validator.jexl</b>
<div class="code">
${
 var foo = 1;
 return result.result;
}
            </div>
          </td></tr>  
          <tr>
            <td>example<br>&nbsp;(script file)<br>&nbsp;@lang="javascript"</td>
            <td><b>assignments/res/testB.validator.js</b>
<div class="code">
var label = serviceResult.testIDLabel;
var result = serviceResult.result;
stdout.println("LOG from javascript: "+label);
stdout.println("LOG from javascript: "+result);
"OK from JS";
            </div>
          </td></tr>  
          
          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.expected" id="RestReplay-restReplay.testGroup.test.response.expected"></a>/restReplay/testGroup/test/response/expected</td>
          </tr>

          <tr>
            <td>@dom</td>

            <td>
              Single element for evaluating the response from the server. Specify the type of comparisons for validation with<br>
              attribute level: can be "ZERO", "TEXT", "ADDOK", "TREE", "TREE_TEXT", and "STRICT".<br>
              (For all tests, whitespace allowed by XML is ignored, and also ignoring whitespace at either end of child node text.<br>
              i.e. a child's text node is trimmed prior to comparison.)



<ul>
                <li>ZERO: does no checking. If the server sends a valid reponse, the reponse succeeds.</li>

                <li>ADDOK: Checks for TEXT differences. Nodes added by server, are allowed. Nodes expected by test but ommitted by server are in error.</li>

                <li>TEXT: makes sure nodes from the server match nodes from the file named in "filename" child element of "response".<br>
                Allows the server to add nodes, e.g. CSID, inAuthority, and other calculated fields may be skipped.</li>

                <li>TREE: makes sure no nodes/children are added or removed.</li>

                <li>TREE_TEXT: makes sure nodes match, and that no nodes/children are added or removed.</li>

                <li>STRICT makes sure all nodes match exactly. This is the strictest level of match.</li>
              </ul>
            </td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <div class="code">...
  &lt;response&gt;
    &lt;expected level="TEXT" /&gt;
              </div>
            </td>
          </tr>

          <tr>
              <td>dom</td>
              <td>child element which contains specific criteria for passing a dom validation. </td>
          </tr>

          <tr>
              <td>Example:</td>

              <td>
                  <div class="code">...
  &lt;expected>
      &lt;dom>
          &lt;MATCHED range="3" />
          &lt;DIFFERENT range="0" />
      &lt;/dom>
  &lt;/expected>
                  </div>
              </td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts" id="RestReplay-restReplay.testGroup.test.response.parts"></a>/restReplay/testGroup/test/response/parts</td>
          </tr>

          <tr>
            <td>parts</td>

            <td>Optional container for part elements. Required if more than one part element.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part" id="RestReplay-restReplay.testGroup.test.response.parts.part"></a>/restReplay/testGroup/test/response/parts/part</td>
          </tr>

          <tr>
            <td>part</td>

            <td>A template containing the schema part expected from the server, as opposed to the actual part sent from the server.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.label" id="RestReplay-restReplay.testGroup.test.response.parts.part.label"></a>/restReplay/testGroup/test/response/parts/part/label</td>
          </tr>

          <tr>
            <td>label</td>

            <td>The name of the schema, such as "objectexit_common", or "collectionspace_core".</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.f..." id="RestReplay-restReplay.testGroup.test.response.parts.part.f..."></a>/restReplay/testGroup/test/response/parts/part/filename</td>
          </tr>

          <tr>
            <td>filename</td>

            <td>The filename of the template for comparing to what the server sent.</td>
          </tr>

          <tr>
            <td colspan="3" class="element-hdr"><a name="RestReplay-restReplay.testGroup.test.response.parts.part.var" id="RestReplay-restReplay.testGroup.test.response.parts.part.var"></a>/restReplay/testGroup/test/response/parts/part/var</td>
          </tr>

          <tr>
            <td>var</td>

            <td>A variable declaration to be passed into the template.</td>
          </tr>

          <tr>
            <td>@ID</td>

            <td>ID defines the variable name that will appear in the expression context, and the text of the var node will be evaluated just prior to comparing the template to the response from the server.</td>
          </tr>

          <tr>
            <td>Example:</td>

            <td>
              <p>The file named in /restReplay/testGroup/test/response/part/filename is a template, which may contain variables.<br>
              Those variables should be defined in var child elements at this level. This keeps complicated variables out of the template file and in the <b>control</b> file. Templates should just expose simple variables, such as ${depositor} and not complicated variables that dig into the objects in the namespace, e.g. this would be considered bad form if found inside a template file:</p>

              <div class="code">
    &lt;!-- DON'T DO THIS IN TEMPLATE FILE --&gt;
    &lt;shortIdentifier&gt;${test2.sent("pa_com","//sid")}&lt;/shortIdentifier&gt;
              </div>

              <p>It would be better to defined that variable in the <b>control</b> file, and then pass that single variable into the template.<br>
              e.g. define this in the template file "objectexit/res/test2GET.res.xml"</p>

              <div class="code">
    &lt;shortIdentifier&gt;<b>${sid}</b>&lt;/shortIdentifier&gt;
              </div>

              <p>then instantiate that variable in the <b>control</b> file:</p>

              <div class="code">
    &lt;response&gt;
      &lt;expected level="TEXT" /&gt;
      &lt;part&gt;
        &lt;label&gt;t2_com&lt;/label&gt;
        &lt;filename&gt;objectexit/res/test2GET.res.xml&lt;/filename&gt;
        &lt;var ID="<b>sid</b>"&gt;${test2.sent("pa_com","//id")}&lt;/var&gt;
      &lt;/part&gt;
    &lt;/response&gt;
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <h4><a name="RestReplay-2.c.4Cleanup" id="RestReplay-2.c.4Cleanup"></a>2.c.4 Cleanup</h4>

      <p>After the testGroup has run, RestReplay will perform cleanup. You may control cleanup via the "autoDeletePOSTS" attribute of "testGroup". If true, then any POSTs that returned a "Location: " header will result in RestReplay sending a DELETE on that Location: URL. If false, RestReplay will perform no automated cleanup for that testGroup. If you called RestReplay programmatically, then you may initiate cleanup manually by calling on these methods of org.dynamide.restreplay.RestReplay</p>

      <div class="code">
    public List&lt;ServiceResult&gt;  autoDelete(String logName);
      </div>

      <p>or</p>

      <div class="code">
    public static List&lt;ServiceResult&gt; autoDelete(Map&lt;String, ServiceResult&gt; serviceResultsMap, String logName);
      </div>


    <h2><a name="RestReplay-3.Examples" id="RestReplay-3.Examples"></a>3. RestReplay Examples</h2>

    <h3><a name="RestReplay-3.a.1.DELETE" id="RestReplay-3.a.1.DELETE"></a>3.a.1 Using DELETE for lists of resources.</h3>

    <p>Say we had a service listening on <b>/api/orders</b> that would return a list of orders we had created.  It might return JSON like this:</p>
    <script type="syntaxhighlighter" class="brush: js"><![CDATA[
      {
        "count":2,
        "orders": [
            "order_id":"abc123",
            "items":[]
        ],
        [
            "order_id":"abc456",
            "items":[]
        ]
      }

     ]]></script>

    <p>Let's say previous tests have populated some Orders, and now we want to clean them all up.  We could use <a href="#RestReplay-restReplay.testGroup">autoDeletePOST</a>
        or set up Delete URLs, but
        here is how to set up the REST workflow manually.
        We could set up two tests in one testGroup in RestReplay: one to call the service to get this list, and a second to
    delete all the resources found on the list.</p>


        <pre class="brush: xml; ">        <test id="getOrdersAfterCreate">
            <method>GET</method>
            <uri>/api/orders</uri>
            <response>
                <validator lang="javascript">orders/res/getOrdersAfterCreate.validator.js</validator>
            </response>
        </test>


          <test id="deleteOrders" loop="${size(getOrdersAfterCreate.ORDER_IDS)}">
              <method>DELETE</method>
              <uri>/api/orders/${getOrdersAfterCreate.ORDER_IDS[this.LoopIndex]}</uri>
          </test>
        </pre>

    <p>The first test calls the file <b>orders/res/getOrdersAfterCreate.validator.js</b>  Here is what is in that file:</p>

    <script type="syntaxhighlighter" class="brush: js"><![CDATA[
var r = JSON.parse(serviceResult.result);

if (r && r.count){
    var stringArray = kit.newStringArray(r.count);
    for (var i=0; i<r.count; i++){
        stringArray[i] = r.orders[i].order_id;
    }
    serviceResult.addExport("ORDER_IDS", stringArray);
    "OK";
}


       ]]></script>





    <p>Now let's walk through what we have done.</p>
    <p>In this example, we first run a test called getOrdersAfterCreate, which gets the list of orders,
        after some other tests have created Order resources on the server.
       </p>

       <p>
        After the response comes back, RestReplay runs any validator found,
           in this case orders/res/getOrdersAfterCreate.validator.js which is shown below.
           This validator looks into the JSON that came back, and digs out the count and the orders order_id's.
           If the count were not sent by your server, you can use Javascript to find the length of the r.orders array.
           This validator builds up a Java Array of String, then passes back to the test as an export.
       </p>
    <p>Note that to create Java arrays of String, or String[], you must call either the long version:
        </p>
<pre class="brush: xml; gutter: false;">var ordersArray = java.lang.reflect.Array.newInstance(java.lang.String, r.count);</pre>
    or the short version:
        

































<pre class="brush: xml; gutter: false;">var ordersArray = kit.newStringArray(theCount);</pre>
    
       <p>Then we run the delete test, which looks at the array of order IDs in the export getOrdersAfterCreate.ORDER_IDS.
       This works because getOrdersAfterCreate is the name of the test, and each test stores its exported vars for
       use by subsequent tests.</p>
       <p>Note that size() is a function provided by Jexl.&nbsp;
        It looks at the length of arrays, and the size of collections.&nbsp;
        Here we use it to tell RestReplay how many times to loop, so that we perform one DELETE request for each ID in the list.
       </p>

    <p>Also, <b>this.LoopIndex</b> is a loop counter provided by RestReplay when looping.</p>

    <p>Specifically, if getOrdersAfterCreate.ORDER_IDS is an array of string like ["abc123","abc456"],
        <br>then in memory it looks like this:
        

































<table class="matrix">
            <tbody>
<tr>
                <th>0</th>
                <td>abc123</td>

            </tr>
            <tr>
                <th>1</th>
                <td>abc456</td>
            </tr>
        </tbody></table>
    </p>

    <p>
    Then size(getOrdersAfterCreate.ORDER_IDS)
        is 2, and loop="${size(getOrdersAfterCreate.ORDER_IDS)}" turns into loop="2", so RestReplay will run deleteOrders 2 times
        so that the following 2 URI's get hit:
    </p>
<blockquote>
        DELETE /api/orders/abc123
        <br>DELETE /api/orders/abc456
    </blockquote>
    because the first time through the loop,
    

































<pre class="brush: xml; gutter: false;"><uri>/api/orders/${getOrdersAfterCreate.ORDER_IDS[this.LoopIndex]}</uri></pre>
    <br>becomes <pre class="brush: xml; gutter: false;"><uri>/api/orders/${getOrdersAfterCreate.ORDER_IDS[0]}</uri></pre>
    <br>becomes <pre class="brush: xml; gutter: false;"><uri>/api/orders/abc123</uri></pre>
    <br>
    <br>Then the second time through,
    <br><pre class="brush: xml; gutter: false;"><uri>/api/orders/${getOrdersAfterCreate.ORDER_IDS[this.LoopIndex]}</uri></pre>
    <br>becomes <pre class="brush: xml; gutter: false;"><uri>/api/orders/${getOrdersAfterCreate.ORDER_IDS[1]}</uri></pre>
    <br>becomes <pre class="brush: xml; gutter: false;"><uri>/api/orders/abc456</uri></pre>

    


    <h3><a name="RestReplay-3.a.2.XPath" id="RestReplay-3.a.2.XPath"></a>3.a.2 Using XPath to dig elements out of XML or JSON.</h3>
      <p>The serviceResult.got() method is used to get data nodes from tree-structured data received from the server.
      the key passed to <b>got()</b> is an XPath that will work on any XML request.  JSON requests are mapped to XML for
      using XPath, and this works well.  You can also use a validator, which will run Javascript and give you JSON dotted syntax.</p>

    <p>In this case, the XPath is <b>//data</b> which means <i>"find the value of the node called data, anywhere in the tree"</i>.</p>

    <p>Note: you can use either <a href="http://www.w3schools.com/xpath/xpath_syntax.asp">XPath</a> or <a href="https://github.com/jayway/JsonPath/blob/master/README.md">JsonPath</a>.</p>

    <p>First, let's say we have a token service, that when called, returns some JSON like so, and all we
        need to grab from the token is the value of the <b>data</b> element from that JSON:</p>
    <script type="syntaxhighlighter" class="brush: js"><![CDATA[
{"status":"success","data":"id=ffffffff540e662de4b01ef1c4c50faf;token-expires=112567"}
     ]]></script>


    <p>Now we call this service like so:</p>
    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
            <test ID="selftestToken">
                <method>GET</method>
                <uri>/tagonomy?mock=token</uri>
            </test>
         ]]></script>

    <p>Subsequent tests can now make the token available to their own templates like so: </p>

    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
            <test ID="UseTokenPOST">
                <method>POST</method>
                <uri>/tagonomy?mock=true</uri>
                <filename>_self_test/selftest-token-post.json</filename>
                <vars>
                    <var ID="TOKEN">${selftestToken.got("//data")}</var>
                </vars>
            </test>
 ]]></script>
    <p>or can use the token in the URI like so:</p>
    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
    <test ID="UseToken">
        <method>GET</method>
        <uri>/tagonomy?mock=true&amp;token=${selftestToken.got("//data")}</uri>
    </test>
      ]]></script>
<p>in which case, the URI would expand to: <span style="display: inline-block; border: 1px solid black;">/tagonomy?mock=true&amp;token=id=ffffffff540e662de4b01ef1c4c50faf;token-expires=112567</span></p>
    <h3><a name="RestReplay-3.a.3.XPath" id="RestReplay-3.a.3.XPath"></a>3.a.3 Using XPath part 2</h3>

    <p>Next we'll show another way to export that same value, and some cleaner ways to use it.
        These are all equivalent to the code above in <a href="#RestReplay-3.a.2.XPath">3.a.2, Using XPath</a></p>
    <p>Note: you can use either <a href="http://www.w3schools.com/xpath/xpath_syntax.asp">XPath</a> or <a href="https://github.com/jayway/JsonPath/blob/master/README.md">JsonPath</a>.</p>
    <p>First, the selftestToken could be modified to export a var</p>

    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
            <test ID="selftestToken">
                <method>GET</method>
                <uri>/tagonomy?mock=token</uri>
                <exports>
                    <vars>
                        <var ID="TOKEN">${this.got("//data")}</var>
                    </vars>
                </export>
            </test>
 ]]></script>


    <p>After which you can use the token in the URI like so:</p>
    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
    <test ID="UseToken">
        <method>GET</method>
        <uri>/tagonomy?mock=true&amp;token=${selftestToken.TOKEN}</uri>
    </test>
      ]]></script>

    <p>or you can use the token in headers like so:</p>
    <script type="syntaxhighlighter" class="brush: xml; "><![CDATA[
    <test ID="UseToken">
        <method>GET</method>
        <uri>/tagonomy?mock=true</uri>
        <headers>
            <header name="x-authorization">${selftestToken.TOKEN}</header>
        </headers>
    </test>
      ]]></script>
      
      
      
       <h3><a name="RestReplay-3.a.4.JexlScript"></a>3.a.4 Jexl Script</h3>
      <p>Expressions in Jexl can span multiple lines, and have return statements, so they can be used as scripts.  In this example, 
      a complicated expression is made manageable by breaking it into lines and steps.  But it is still one "expression".</p>
        
        This example shows that in a var, you can use <a href="http://commons.apache.org/proper/commons-jexl/reference/syntax.html">Jexl2 Expressions</a>. 
              <br>Note that <b>kit</b> is predefined to be valid inside a Jexl evaluator.<br>Note the use of CDATA to protect the jexl from xml rules.&nbsp; If you don't use the characters: &lt;,&nbsp; and &amp;, you can skip the CDATA.<br>The CDATA begins with <strong style="color: #3366ff;">&lt;![CDATA[</strong> and ends with <strong><span style="color: #3333ff;">]]&gt;&nbsp;</span></strong> <br>The Jexl begins with <strong style="color: #3366ff;">${</strong> and ends with <strong style="color: #3366ff;">}</strong><br>
<div class="code"> &lt;var ID="MyGregorianDate"&gt;&lt;![CDATA[<br>  <strong style="color: #3366ff;">${</strong>
     if (kit != null) {
        var ts = kit.gregorian.timestampUTC();
        kit.out.println('');
        kit.out.println(' ==&gt; Running test script, in selftest.xml:selftestGroup:selftestScriptTest at '+ts);
        kit.out.println('');
        return ''+ts;
     }
     return "kit not defined in selftestScriptTest";
  <strong style="color: #3366ff;">}</strong><br>]]&gt;&lt;/var&gt;               </div>
    
                                                               
                                                               
  <h3><a name="RestReplay-3.a.x.MoreExamples"></a>3.a.x More Examples</h3>
<p>The best source for examples are the ones that run every time we build or install RestReplay: our _self-test.  
   This ships with every RestReplay.jar, and can be unpacked from there, or can be seen on our <a href="https://github.com/dynamide/RestReplay/tree/master/src/main/resources/restreplay/_self_test">_self-test GitHub page</a>. </p>
<p>You can see the reports produced by our _self-test here: <a href="http://dynamide.org/RestReplay/reports/index._self_test.master-self-test.html">Sample Reports</a>.</p>
<p>Especially, you can see all our tests here:
                                                               <br><a href="https://github.com/dynamide/RestReplay/blob/master/src/main/resources/restreplay/_self_test/self-test.xml">self-test.xml</a>
                                                               <br><a href="https://github.com/dynamide/RestReplay/blob/master/src/main/resources/restreplay/_self_test/master-self-test.xml">master-self-test.xml</a>
                                                               <br>You can run these tests with a command line like this, which will dump reports into the current directory in a directory called ./reports 
                                                               <br>  
                                                               </p><div class="code">   java -jar ./RestReplay-1.0.4-standalone.jar -selftest -testdir ./</div>
                                                               <br>
                                                               <p>You can unpack the examples with this command:</p>
                                                               
                                                               <div class="code">   jar xvf ./RestReplay-1.0.4-standalone.jar</div>
                                                               <p>Once unpacked, you'll see our _self-test in ./restreplay/_self_test/, 
                                                               and you notice that ./restreplay/ is our effective -testdir.</p>
      
<hr>


      
      
      
        

      
    </div>
  </div>

  <div style="margin: 30px; border: 1px solid black; background-color: #87cefa; border-radius: 5px; padding: 30px;">
      <a href="http://dynamide.org/RestReplay/">RestReplay</a> and <a href="http://dynamide.org/">dynamide.org</a> are licensed under Apache 2.0.  See our <a href="https://github.com/dynamide/RestReplay/blob/master/LICENSE">LICENSE</a>.
  </div>
<script>
    debugger;
    var tm = document.getElementById("TOCMASTER");
    var tt = document.getElementById("TOCTEST");
    var d1 = document.getElementById("TOCDEST1");
    d1.innerHTML = tm.innerHTML;
    var d2 = document.getElementById("TOCDEST2");
    d2.innerHTML = tt.innerHTML;  
</script>
  
  <!--Run the JS highlighter, you need to include this JS on your page -->
<script type="text/javascript">
SyntaxHighlighter.defaults['class-name'] = 'mojonixon';
     SyntaxHighlighter.all()
</script>
</body></html>